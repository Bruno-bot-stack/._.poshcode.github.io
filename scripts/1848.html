
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="PoshCode - Community resources for PowerShell coders">
    <meta name="author" content="Gene Magerr">
    <title>Profile Function - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title">Profile Function</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2010-05-15</span> by <a class="blog-post-author">Gene Magerr</a>
    </p>

    <h1>Profile Function</h1>
<h3><a href="//scripts/1848.ps1">download</a></h3>
<p>I have this function in my powershell profile. It will ask me if i want to start a transcript when I launch Posh. There's some conditional logic, it'll ask if you want to start the transcript. If you say yes it'll check to see if the Transcripts folder exists, if it doesn't it'll be created. Pretty cool. Got the main part of the code from Shay Levy's site and modified it.</p>
<pre><code class="language-posh">########################################################
# This function will prompt the user asking if they want
# to start a transcript file. It will loop until the user
# types y or n. If the user selects y, the script will
# check to see if the transcript exists. If it doesn't
# it is created. If it does, the transcript file is created.
# The transcript started message, and folder creation
# message are all piped to null. Modified script from
# Shay's site http://blogs.microsoft.co.il/blogs/ScriptFanatic
########################################################
function Save-Transcript{
$global:TRANSCRIPT = &quot;C:\Scripts\PowerShell\Transcripts\PSLOG_{0:dd-MM-yyyy}.txt&quot; -f (Get-Date)
Start-Transcript -Append | out-null
}
 
do{$a = Read-Host &quot;Do you want to start a transcript? y/n&quot;}
Until($a -ne &quot;&quot;) 
If($a -eq &quot;y&quot;)
{
if (Test-Path C:\Scripts\PowerShell\Transcripts)
{
&quot;C:\Scripts\PowerShell\Transcripts&quot;
}
else
{
New-Item C:\Scripts\PowerShell\Transcripts -type directory | out-null
}
Save-Transcript
}
</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>