
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="PoshCode - Community resources for PowerShell coders">
    <meta name="author" content="vanwyngaarden">
    <title>Robocopy Analyser - PoshCode</title>

    <link rel="stylesheet" href="/css/superhero.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/highlight/arta.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" id="tabs">
                    <li class="nav-item"><a class="nav-link" href="/">Join Us!</a></li>
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video">Videos</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

	<div class="container">
		<div class="blog-header">
			<h1 class="blog-title">PoshCode</h1>
			<p class="lead blog-description">Community resources for PowerShell coders</p>
		</div>
		<div class="row">
            

<div class="blog-post">
    <h2 class="blog-post-title">Robocopy Analyser</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2015-03-16</span> by <a class="blog-post-author">vanwyngaarden</a>
    </p>

    <h3><a href="/scripts/5787.ps1">download Robocopy Analyser.ps1</a></h3>
<p>Search true log files generated by Robocopy for error / success messages</p>
<pre><code class="language-powershell">function Analyse-Robocopy {
&lt;# 
   .Synopsis 
    This function analyse output logging for robocopy  
   .Description 
    This function analyse output logging for robocopy  
   .Example 
    Analyse-Robocopy -sourcefile d:\robocopy.log -resultfile d:\robocopy-result.log -messages Error
    This command wil generate a new logfile with all Error messages found in sourcefile
   .Example
    Analyse-Robocopy -sourcefile d:\robocopy.log -messages Error
    This command wil generate a new logfile with all Error messages found in sourcefile and place it in C:\temp\Robocopy-Analyse.log
	when the folder C:\Temp not exist the folder will be created
   .Parameter sourcefile 
    The name and location of the file you want to analyse
   .Parameter resultfile
    The location where the result will be saved.
	Default value is c:\Temp\Robocopy-Analyse.log
   .Parameter Messages 
    specify the sort messages you want to find
	Default value is Error
   .Notes 
    NAME:  Analyse-Robocopy
    AUTHOR: Marco van Wyngaarden 
    LASTEDIT: 03/16/2015 14:40 
    KEYWORDS: Robocopy, Analyser
   .Link 
     http://vanwyngaarden.eu/powershell/robocopy-analyser
#&gt; 
	Param(
	[Parameter(Position=0, Mandatory=$True, ValueFromPipeline=$True)] [string]$sourcefile,
  	$resultfile = &quot;c:\temp\robocopy-Analyse.log&quot;,
	[ValidateSet(&quot;Error&quot;,&quot;success&quot;)] [String] $messages = &quot;Error&quot;
   )
   
   #check if resultfile is given otherwise fill resultfile with default value
   if ($resultfile -eq &quot;c:\temp\robocopy-Analyse.log&quot;){
    	if (!(Test-Path -Path &quot;c:\temp&quot;)){ 
       		New-Item -ItemType directory -Path &quot;c:\temp&quot; | Out-Null
		}
	}	
	#check message type and search logfile
	if ($messages -eq 'Error'){ 
		$output = Get-ChildItem $sourcefile | Select-String -Pattern '(error 123)| (error 32)' 
		$output | Out-File $resultfile -Width 1200
	}
	else{
		$output = Get-ChildItem $sourcefile | Select-String -Pattern '(New File) | (New Dir )' 
		$output | Out-File $resultfile -Width 1200
	}
	Write-Host &quot; ------------------------------------------------&quot;
   	Write-Host &quot; ROBOCOPY LOG ANALYSER &quot;
	Write-Host &quot; ------------------------------------------------&quot;
	Write-Host &quot; &quot;
	Write-Host &quot;&quot; Counted $output.count $messages messages.&quot;&quot;
	Write-Host &quot;&quot; Results are saved in $resultfile&quot;&quot;
 	Write-Host &quot; &quot;
	Write-Host &quot; ------------------------------------------------&quot;
}

</code></pre>

</div>
			<!-- sidebar? -->
		</div>
		<hr>
		<footer class="blog-footer">
			<p>Generated by Joel &quot;Jaykul&quot; Bennett - 2018</p>
		</footer>
	</div> <!-- /container -->

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>
    <script src="/js/vendor/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>