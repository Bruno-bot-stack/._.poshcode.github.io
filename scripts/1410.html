
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Sign up for PowerShell.Slack.com">
    <meta name="author" content="Joel Bennett">
    <title>Copy-Function - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title">Copy-Function</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2009-10-21</span> by <a class="blog-post-author">Joel Bennett</a>
    </p>

    <h1>Copy-Function</h1>
<h3><a href="//scripts/1410.ps1">download</a></h3>
<p>Copy a function from your current session to another session. Allows you to easily copy function definitions into remote PSSessions.</p>
<pre><code class="language-posh">#Requires -Version 2.0

&lt;#
   .Synopsis
      Copy a function from the current session to another session
   .Description
      Copies a function deffinition from the current session into any other session
   .Parameter Session
      The session(s) you want to define the function in
   .Parameter Name
      The Name of the function to copy
   .Parameter Definition
      The optional definition of the function. This is used to allow copying via the pipeline.
   .Parameter Force
      Overwrite existing functions in the session.
   .Parameter Passthru
      Output the FunctionInfo from the session
   .Example
      Copy-Function -Session $Session1 -Name Prompt -Force
        
      Copies the prompt function from the current session into the specified session, overwriting the existing prompt function.
   .Example
      Get-Command -Type Function | Copy-Function $Session1
      
      Copies all of the functions from the current session into the new session.
   .Notes
      
    
#&gt;
function Copy-Function {
[CmdletBinding(SupportsShouldProcess=$true)]
Param(
   [Parameter(Mandatory=$true, Position=0)]
   [System.Management.Automation.Runspaces.PSSession[]]
   $Session, 

   [Parameter(ValueFromPipeline=$true,ValueFromPipelineByPropertyName=$true,Mandatory=$true,Position=1)]
   [String]
   $name, 

   [Parameter(ValueFromPipelineByPropertyName=$true,Mandatory=$false)]
   [String]
   $Definition,
   
   [Switch]
   $Force,
   
   [Switch]
   $Passthru
   
)

Process { 
   if( $PSCmdlet.ShouldProcess(&quot;Copied function $Name to sessions: $(($Session|select -expand Name) -join ', ')&quot;,&quot;Copy function `&quot;$Name`&quot;?&quot;,&quot;Copying functions to sessions: $(($Session|select -expand Name) -join ', ')&quot;) ) {
      if(!$Definition){ $Definition = (gcm -type function $name).Definition }
      If(!$Passthru) {
         Invoke-Command { 
            Param($name, $value, $force) 
            $null = new-item function:&quot;$name&quot; -value $value -force:$force
         } -Session $Session -ArgumentList $Name,$Definition,$Force
      } else {
         Invoke-Command { 
            Param($name, $value, $force) 
            new-item function:&quot;$name&quot; -value $value -force:$force
         } -Session $Session -ArgumentList $Name,$Definition,$Force
      }   
   }
}
}
</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>