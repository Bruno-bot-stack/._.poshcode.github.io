
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Sign up for PowerShell.Slack.com">
    <meta name="author" content="Joel Bennett">
    <title>Send-SmtpMessage - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title">Send-SmtpMessage</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2008-04-18</span> by <a class="blog-post-author">Joel Bennett</a>
    </p>

    <h1>Send-SmtpMessage</h1>
<h3><a href="//scripts/180.ps1">download</a></h3>
<p>Send an email via the GMail SMTP server (or any server, really, but there's some extra code in here and defaults that will make it work with Gmail so you won't have to do research).  NOTE: there's a Send-SmtpMail in PSCX, but as far as I can tell, there's no way to convince it to use SSL so I can't get it to work with Gmail at all.</p>
<pre><code class="language-posh">## Send-SmtpMessage -- a special implementation to show how to send via GMail
## GMail is a bit more complicated than most....
###################################################################################################
## Examples:
## Send-SmtpMessage &quot;receiver@gmail.com&quot; &quot;Hello there&quot; &quot;This is an important email&quot;
##       sends a message after prompting you for your login credentials... 
##       notice this will use your login as the FROM email (gmail will force that anyway)
## 
## Send-SmtpMessage &quot;receiver@gmail.com&quot; &quot;Hello there&quot; &quot;This is an important email&quot; `
##   $(New-Object Net.NetworkCredential &quot;Username&quot;,&quot;Password&quot;) `
##   &quot;Sender@Server.com&quot; &quot;smtp.Server.com&quot; $null
##       sends a message without prompting, and specifies the sender and server address...
###################################################################################################
## Revision History
## 1.2 - Works for gmail now
## 1.0 - Works for me
###################################################################################################
param (
   [Net.Mail.MailAddress]$to = $(Read-Host &quot;Email address to send to (eg: receiver@hotmail.com)&quot;)
  ,[string]$Subject = $(Read-Host &quot;Email Subject&quot;)
  ,[string]$Body = $(Read-Host &quot;Main Email Body&quot;)
  ## Note your login name for gmail is: user@gmail.com
  ,[Net.NetworkCredential]$credentials = $(Get-Credential)

  ,[Net.Mail.MailAddress]$from = $null
  ,[string]$Server=&quot;smtp.gmail.com&quot;  # Change this to your server address
  ,[int]$Port=587                    # Does anyone other than gmail use this port?
)
## Fix up the credentials for Gmail
## (gmail requires user@gmail.com in the username, and NOTHING in the domain)
$credentials.UserName += &quot;@&quot; + $credentials.Domain
$credentials.Domain = &quot;&quot;

if(!$from) { 
  $from = $credentials.UserName
}

## Most (not gmail) servers will not need to specify a port
if($Port) {
   $mail = new-object Net.Mail.SmtpClient $Server,$Port
} else {
   $mail = new-object Net.Mail.SmtpClient $Server
}

$mail.Credentials = $credentials
## Gmail _requires_ Ssl -- most others seem to have it as an option, nowadays
$mail.EnableSsl = $true

## And finally ....
$mail.Send($From,$To,$Subject,$Body)


</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>