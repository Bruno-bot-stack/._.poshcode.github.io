
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="PoshCode - Community resources for PowerShell coders">
    <meta name="author" content="MatthewASchmitt">
    <title>Check Service on Servers - PoshCode</title>

    <link rel="stylesheet" href="/css/superhero.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/highlight/arta.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" id="tabs">
                    <li class="nav-item"><a class="nav-link" href="/">Join Us!</a></li>
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video">Videos</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

	<div class="container">
		<div class="blog-header">
			<h1 class="blog-title">PoshCode</h1>
			<p class="lead blog-description">Community resources for PowerShell coders</p>
		</div>
		<div class="row">
            

<div class="blog-post">
    <h2 class="blog-post-title">Check Service on Servers</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2012-11-29</span> by <a class="blog-post-author">MatthewASchmitt</a>
    </p>

    <h3>Download <a href="/scripts/3803.ps1">Check Service on Servers.ps1</a> - <a href="/scripts/3802.html">parent</a></h3>
<p>If you download or use, please tweet it or email me.  Thanks!</p>
<p>This project is in response to &quot;script to monitor a service on a server&quot; script request:  http://gallery.technet.microsoft.com/scriptcenter/site/requests/script-to-monitor-a-service-on-a-server-636b6a0d?ShowSubmitLinkForm=False</p>
<p>This script checks the status for a defiled service for a group of servers, listed in the serverList.txt file.  In this case the CPSVS service.  However this can be changed to the name of the service you want to check.  It exports the status of the service for each server.  After that, it sends the output file as an attachment in an email to a defined group of addresses.</p>
<p>To use this script your will need to make some changes in the scritp:</p>
<p>Create Server list and save to serverList.txt file
Adjust the import location of the serverList.txt file on Line 15
Change the service - to the service you want to check
Adjust the output location of the ServerServiceStatus.csv file on line 27
Adjust the email address on Line 32.
To use more than one email address, separtate with a comma:
recipient1@domain.com, recipient2@domain.com
Adjust the SmtpServer address on Line 32</p>
<p>I hope you find this useful!  Comments and suggestions are welcome!</p>
<p>Matt</p>
<pre><code class="language-powershell">&lt;#
  Author:   Matt Schmitt
  Date:     11/29/12 
  Version:  1.0 
  From:     USA 
  Email:    ithink2020@gmail.com 
  Website:  http://about.me/schmittmatt
  Twitter:  @MatthewASchmitt
  
  Description
  A script for checking the status of a service on a group of servers, from a list in a file.  
#&gt;


$serverList = Import-Csv 'c:\serverList.csv'

&quot;Server&quot; +&quot;`t&quot; + &quot;Status&quot; | Out-File c:\ServerService.csv


foreach ($element in $serverList) 
{
    
    $sStatus = get-service -Name &quot;CPSVS&quot; | Select-Object -expand Status

    $server = $element | Select-Object -expand Server

    $server + &quot;`t&quot; + $sStatus | Out-File -append c:\ServerServiceStatus.csv

} 


Send-MailMessage -From donotreply@test.com -To recipient@domain.com -subject &quot;Spooler Service Report&quot; -Body &quot;Attached is Server Service report.&quot; -Attachments &quot;c:\ServerServiceStatus.csv&quot; -SmtpServer &quot;xxx.xxx.xxx.xxx&quot;
</code></pre>

</div>
			<!-- sidebar? -->
		</div>
		<hr>
		<footer class="blog-footer">
			<p>Generated by Joel &quot;Jaykul&quot; Bennett - 2018</p>
		</footer>
	</div> <!-- /container -->

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>
    <script src="/js/vendor/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>