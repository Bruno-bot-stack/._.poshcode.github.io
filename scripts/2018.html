
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Sign up for PowerShell.Slack.com">
    <meta name="author" content="George Howarth">
    <title>Test-64BitOS - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title">Test-64BitOS</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2010-07-23</span> by <a class="blog-post-author">George Howarth</a>
    </p>

    <h1>Test-64BitOS</h1>
<h3><a href="//scripts/2018.ps1">download</a></h3>
<p>This function will determine whether the local operating system architecture is 64-bit. This has been converted to PowerShell from the original C# code produced by &quot;Stefan Schultze
&quot;:http://stackoverflow.com/questions/336633/how-to-detect-windows-64-bit-platform-with-net</p>
<p>Thanks Stefan!</p>
<pre><code class="language-posh">Add-Type -TypeDefinition @&quot;
using System;
using System.Runtime.InteropServices;

public static class Win32Api
{
    [DllImport(&quot;Kernel32.dll&quot;, EntryPoint = &quot;IsWow64Process&quot;)]
    [return: MarshalAs(UnmanagedType.Bool)]
    public static extern bool IsWow64Process(
        [In] IntPtr hProcess,
        [Out, MarshalAs(UnmanagedType.Bool)] out bool wow64Process
    );
}
&quot;@

&lt;#
    .SYNOPSIS
        Determines whether the architecture of the local operating system is 64-bit.

    .DESCRIPTION
        The Test-64BitOS function uses the IsWow64Process function to determine whether the process is running under WOW64. It also checks whether the process is 64-bit in this test.

    .INPUTS
        None
            This function does not accept any input.

    .OUTPUTS
        None
            This function does not return any output.

    .NOTES
        Using this function is more reliable than other methods as the function uses a method provided by the operating system to determine whether the process is running under WOW64.
                    
    .EXAMPLE
        C:\PS&gt; Test-64BitOS
        
        This example shows how to use the Test-64BitOS function.
        
    .LINK
        
#&gt;
function Test-64BitOS
{
    return (Test-64BitProcess) -or (Test-Wow64)
}

function Test-64BitProcess
{
    return [IntPtr]::Size -eq 8
}

function Test-Wow64
{
    if ([Environment]::OSVersion.Version.Major -eq 5 -and 
        [Environment]::OSVersion.Version.Major -ge 1 -or 
        [Environment]::OSVersion.Version.Major -ge 6)
    {
        $process = [System.Diagnostics.Process]::GetCurrentProcess()
        
        $wow64Process = $false
        
        if (![Win32Api]::IsWow64Process($process.Handle, [ref]$wow64Process))
        {
            return $false
        }
        
        return $wow64Process
    }
    else
    {
        return $false
    }
}

Test-64BitOS
</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>