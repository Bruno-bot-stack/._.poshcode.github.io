
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="PoshCode - Community resources for PowerShell coders">
    <meta name="author" content="Jan Egil Ring">
    <title>New-DFSRHealthReport - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title">New-DFSRHealthReport</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2010-12-30</span> by <a class="blog-post-author">Jan Egil Ring</a>
    </p>

    <h1>New-DFSRHealthReport</h1>
<h3><a href="//scripts/2427.ps1">download</a></h3>
<p>A Windows PowerShell-script for generating an HTML-report for DFS-R SYSVOL and sending it via e-mail.</p>
<p>For more information, see the following blog-post:
http://blog.powershell.no/2010/12/30/dfs-r-health-report-for-sysvol</p>
<pre><code class="language-posh">&lt;#

 NAME: New-DFSRHealthReport.ps1

 AUTHOR: Jan Egil Ring
 EMAIL: jan.egil.ring@powershell.no

 COMMENT: Script to generate a new DFS-R HTML Health Report for the Domain System Volume (SYSVOL) replication group using the native dfsradmin.exe tool.
          More information: 

 You have a royalty-free right to use, modify, reproduce, and
 distribute this script file in any way you find useful, provided that
 you agree that the creator, owner above has no warranty, obligations,
 or liability for such use.

 VERSION HISTORY:
 1.0 30.12.2010 - Initial release

#&gt;

#requires -version 2

#Initial variable
$ReportFilePath = &quot;C:\Reports\DFS-R\Health-report-&quot;+(Get-Date -UFormat %Y-%m-%d)
$ReferralDC = &quot;domain\srv-dc-01&quot;
$SmtpServer = &quot;srv-smtp-01.domain.local&quot;
$EmailFrom = &quot;dfs-r@domain.local&quot;
$EmailTo = &quot;user@domain.local&quot;

#Run DfsrAdmin.exe to generate report
DfsrAdmin.exe Health New /RgName:`&quot;Domain System Volume`&quot; /RefMemName:$ReferralDC /RepName:$ReportFilePath /FsCount:true

#Send HTML-report to the specified e-mail address
Send-MailMessage -From $EmailFrom -To $EmailTo -SmtpServer $SmtpServer -Subject &quot;DFS-R Health Report 2010-12-30&quot; -Body &quot;The DFS-R Health Report is attched to this e-mail&quot; -Attachments ($ReportFilePath+&quot;.html&quot;)
</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>