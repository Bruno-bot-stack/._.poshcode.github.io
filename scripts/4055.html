
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Sign up for PowerShell.Slack.com">
    <meta name="author" content="chriskenis">
    <title>SpeakToMe - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title">SpeakToMe</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2013-03-27</span> by <a class="blog-post-author">chriskenis</a>
    </p>

    <h1>SpeakToMe</h1>
<h3><a href="//scripts/4055.ps1">download</a></h3>
<p>MSagent speech script with voice selection and interluded speaking</p>
<p>https://github.com/chriskenis/POSH.git</p>
<pre><code class="language-posh">&lt;#
inspired by HelloKitty script and Mike Hays's obsession for Julie Andrews
added voice selection menu, should work for everyone anywhere
interluded speaking by using string array joined with newline
still need to figure out $voiceToUse code, it's working but I don't know why or how
https://github.com/chriskenis/POSH.git
#&gt;

[CmdletBinding()]
param(
[string] $Name = [Environment]::UserName,
[string[]] $Greetings = @(&quot;This is your computer speaking&quot;,&quot;It is now $(Get-Date)&quot;,&quot;The end&quot;),
[byte] $Speed = 1
)

process{
$message = @&quot;
        .-. __ _ .-.
        |  `  / \  |
        /     '.()--\
       |         '._/
      _| O   _   O |_
      =\    '-'    /=
        '-._____.-'
        /`/\___/\`\
       /\/o     o\/\
      (_|         |_)
        |____,____|
        (____|____)
		
	Hello World
&quot;@
Write-Host $message -foregroundcolor magenta
$voice = new-object -com SAPI.SpVoice
$voice.Voice =  $(SelectVoice $voice)
$voice.Rate = $Speed

}

begin{
# script variables
$nl = [Environment]::NewLine

Function SelectVoice($VoiceCom){
$voiceList = $VoiceCom.GetVoices()
$voiceDescList = @()
For ($i=0; $i -lt $voiceList.Count; $i++){
	$voiceDescList += $($voiceList.Item($i).GetDescription())
	write-verbose &quot;$voiceDescList[$i]&quot;
	}
Write-Host &quot;$nl Voice Selection: $nl&quot;
For ($i=0; $i -lt $voiceList.Count; $i++){Write-Host -ForegroundColor Green &quot;$i --&gt; $($voiceDescList[$i])&quot;}
Write-Host -ForegroundColor Green &quot;q --&gt; quit script&quot;
Do {
	$SelectIndex = Read-Host &quot;Select voice by number or 'enter' (=default voice)&quot;
	Switch -regex ($SelectIndex){
		&quot;^q.*&quot; 	{$SelectIndex=&quot;quit&quot;; $kip = $true}
		&quot;\d&quot; 	{$SelectIndex = $SelectIndex -as [int];$kip = $false}
		&quot;^\s*$&quot; {$SelectIndex=0; $kip = $false}
		}
	}
Until (($SelectIndex -lt $voiceList.Count) -OR $SelectIndex -like &quot;q*&quot;)
If ($kip) {exit}
$voiceMember = &quot;Name=&quot; + $voiceDescList[$SelectIndex]
write-verbose &quot;$voiceMember&quot;
$voiceToUse = $VoiceCom.GetVoices($voiceMember.Id).Item($SelectIndex)
write-verbose &quot;Voice to use = $($voiceToUse.Id)&quot;
return $voiceToUse
}

}

end{
[void]$voice.speak(&quot;Hi $Name, &quot; + $nl + [string]::join($nl,$Greetings))
}
</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>