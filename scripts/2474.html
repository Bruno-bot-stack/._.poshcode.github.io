
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="PoshCode - Community resources for PowerShell coders">
    <meta name="author" content="Jan Egil Ring">
    <title> - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title"></h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2011-01-23</span> by <a class="blog-post-author">Jan Egil Ring</a>
    </p>

    <h1></h1>
<h3><a href="//scripts/2474.ps1">download</a></h3>
<p>PowerShell functions to export and import WLAN profiles in Windows Vista/Windows 7</p>
<p>For more information, see the following blog-post:
http://blog.powershell.no/2011/01/23/export-and-import-wlan-profiles</p>
<pre><code class="language-posh">&lt;#

 NAME: WLAN-functions.ps1

 AUTHOR: Jan Egil Ring
 EMAIL: jan.egil.ring@powershell.no

 COMMENT: PowerShell functions to export and import WLAN profiles in Windows Vista/Windows 7

          Required version: Windows PowerShell 2.0 (built-in to Windows 7)
		  Usage: Either copy the functions directly into a PowerShell session, or dot-source the script
		  to make the functions available (. .\WLAN-functions.ps1)
		            
          For more information, see the following blog-post:
		  http://blog.powershell.no/2011/01/23/export-and-import-wlan-profiles
      
 You have a royalty-free right to use, modify, reproduce, and
 distribute this script file in any way you find useful, provided that
 you agree that the creator, owner above has no warranty, obligations,
 or liability for such use.

 VERSION HISTORY:
 1.0 23.01.2011 - Initial release
 
#&gt;

function Export-WLAN {
&lt;#
.SYNOPSIS
Exports all-user WLAN profiles
.DESCRIPTION
Exports all-user WLAN profiles to Xml-files to the specified directory using netsh.exe
.PARAMETER XmlDirectory
Directory to export Xml configuration-files to
.EXAMPLE
Export-WLAN -XmlDirectory c:\temp\wlan
#&gt;

[CmdletBinding()]
    param (
        [parameter(Mandatory=$true)]
        [string]$XmlDirectory
		)

#Export all WLAN profiles to specified directory
$wlans = netsh wlan show profiles | Select-String -Pattern &quot;All User Profile&quot; | Foreach-Object {$_.ToString()}
$exportdata = $wlans | Foreach-Object {$_.Replace(&quot;    All User Profile     : &quot;,$null)}
$exportdata | ForEach-Object {netsh wlan export profile $_ $XmlDirectory}
}

function Import-WLAN {
&lt;#
.SYNOPSIS
Imports all-user WLAN profiles based on Xml-files in the specified directory
.DESCRIPTION
Imports all-user WLAN profiles based on Xml-files in the specified directory using netsh.exe
.PARAMETER XmlDirectory
Directory to import Xml configuration-files from
.EXAMPLE
Import-WLAN -XmlDirectory c:\temp\wlan
#&gt;

[CmdletBinding()]
    param (
        [parameter(Mandatory=$true)]
        [string]$XmlDirectory
		)

#Import all WLAN Xml-files from specified directory
Get-ChildItem $XmlDirectory | Where-Object {$_.extension -eq &quot;.xml&quot;} | ForEach-Object {netsh wlan add profile filename=($XmlDirectory+&quot;\&quot;+$_.name)}
}
</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>