
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="PoshCode - Community resources for PowerShell coders">
    <meta name="author" content="Rajaa">
    <title>Power shell - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title">Power shell</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2014-09-30</span> by <a class="blog-post-author">Rajaa</a>
    </p>

    <h1>Power shell</h1>
<h3><a href="//scripts/5472.ps1">download</a></h3>
<p>I am looking for a help, hope nobody will gala me for being an ignorant</p>
<pre><code class="language-posh">I am looking for a help, hope nobody will gala me for being an ignorant. Not that long ago I became something of an AD admin, organisation is big so the tasks vary. I can easily complete what I require via snap-ins in most cases. However I have a task on my hands that exceed my &quot;creativity&quot;. I want to change security groups scop from Global to domain local and need to compare the users in other forest (Two way relationship) if users is available that users need to add in this security group. My two problems are: -I am very new to scripting and getting increasingly frustrated that I can't comprehend it 
and make my scripts work as I need them to -Deadline for this task and other responsibilities give me little
time to read more on scripting basics and learn. As such I am in most cases forced to look for script snippets on the web and modify them a bit to meet my needs. This worked up until now as the script I have on my hands is a bit too complex for me.
Biggest problem I was facing so far is creating a forest-wide search. My organization have a Two forest with two way trust relationship.
(Find all security groups in a branch of Active Directory.  Ie.  All groups in a given OrganizationalUnit and child OUs.

For each security groupâ€¦
                If the name is on a list of those that should not be converted then skip to next security group
                Determine what type it is
                If it is global then convert it to domain local

                Enumerate the members of the list

                For each member
                                If the member is a user account then
                                                Determine the users sAMAccountName (short login name)
                                                Create a foreign security principal for the equivalent account in other forest domain
                                                Add the foreign security principal to the list
                                End if
                Next member
Next security group).


Get-ADGroup -Filter {GroupCategory -eq &quot;Security&quot; -and GroupScope -eq &quot;Global&quot;} | Set-ADGroup -GroupScope Universal

and 

Get-ADGroup -Filter {GroupCategory -eq &quot;Security&quot; -and GroupScope -eq &quot;Universal&quot;} | Set-ADGroup -GroupScope Domainlocal

</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>