
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="PoshCode - Community resources for PowerShell coders">
    <meta name="author" content="asdfads">
    <title>Publish-File - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title">Publish-File</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2010-11-11</span> by <a class="blog-post-author">asdfads</a>
    </p>

    <h1>Publish-File</h1>
<h3><a href="//scripts/2356.ps1">download</a> - <a href="//scripts/2126.md">parent</a></h3>
<p>Use this to upload one or more files to a SharePoint document library. Should also work with any WebDAV service, although that hasn't been tested. The filename parameter expects fileinfo objects. Easiest way to do so is to pass them on the pipeline from Get-ChildItem.  This script is a refinement of a technique that I first saw here: http://blogs.flexnetconsult.co.uk/colinbyrne/PermaLink,guid,a326572f-8f78-4c80-86d5-1fe52cbd6fe5.aspx.</p>
<p>The credential parameter is optional. If you do not supply it, then your currently logged-in credentials are used.</p>
<ul>
<li>9/9/10: added UrlPathEncode to ensure files with a space in them will work</li>
</ul>
<pre><code class="language-posh"># Note that this version will not descend directories.
function Publish-File {
	param (
		[parameter( Mandatory = $true, HelpMessage=&quot;URL pointing to a SharePoint document library (omit the '/forms/default.aspx' portion).&quot; )]
		[System.Uri]$Url,
		[system.Management.Automation.PSCredential]$Credential,
		[parameter( Mandatory = $true, ValueFromPipeline = $true, HelpMessage=&quot;One or more files to publish. Use 'dir' to produce correct object type.&quot; )]
		[System.IO.FileInfo[]]$FileName
	)
	Add-Type -AssemblyName System.Web
	$wc = new-object System.Net.WebClient
	if ( $Credential ) { $wc.Credentials = $Credential }
	else { $wc.UseDefaultCredentials = $true }
	$FileName | ForEach-Object {
		$DestUrl = [system.Web.HttpUtility]::UrlPathEncode( ( &quot;{0}{1}{2}&quot; -f $Url.ToString().TrimEnd(&quot;/&quot;), &quot;/&quot;, $_.Name ) )
		Write-Verbose &quot;$( get-date -f s ): Uploading file: $_&quot;
		Write-Verbose &quot;url: $DestUrl&quot;
		$wc.UploadFile( $DestUrl , &quot;PUT&quot;, $_.FullName )
		Write-Verbose &quot;$( get-date -f s ): Upload completed&quot;
	}
	
}

# Example:
# dir c:\path\files* | Publish-File -Url &quot;https://mysharepointsite.com/personal/userID/Personal%20Documents&quot;
</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>