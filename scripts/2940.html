
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="PoshCode - Community resources for PowerShell coders">
    <meta name="author" content="AlphaSun">
    <title>Local Software Inventory - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title">Local Software Inventory</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2011-08-31</span> by <a class="blog-post-author">AlphaSun</a>
    </p>

    <h1>Local Software Inventory</h1>
<h3><a href="//scripts/2940.ps1">download</a></h3>
<p>This script will create (using COM) an MS Excel spreadsheet of all the software installed on the local machine. Basic information about the software, as provided in the registry, is also included. When the script has completed the data collection, all columns are set to &quot;Auto Fit&quot; for width and blank rows in the spreadsheet are removed.</p>
<pre><code class="language-posh"># Create a new Excel object using COM
$Excel = New-Object -ComObject Excel.Application
$Excel.Visible = $True
$Excel.DisplayAlerts = $False

# Counter variable for rows
$intRow = 1

$Excel = $Excel.Workbooks.Add()
$Sheet = $Excel.Worksheets.Item(1)

#Create column headers
$Sheet.Cells.Item($intRow,1)  = &quot;Software Vendor&quot;
$Sheet.Cells.Item($intRow,1).Font.Bold = $True
$Sheet.Cells.Item($intRow,2)  = &quot;Software Name&quot;
$Sheet.Cells.Item($intRow,2).Font.Bold = $True
$Sheet.Cells.Item($intRow,3)  = &quot;Version&quot;
$Sheet.Cells.Item($intRow,3).Font.Bold = $True
$Sheet.Cells.Item($intRow,4)  = &quot;Estimated Size (KB)&quot;
$Sheet.Cells.Item($intRow,4).Font.Bold = $True
$Sheet.Cells.Item($intRow,5)  = &quot;Installation Date&quot;
$Sheet.Cells.Item($intRow,5).Font.Bold = $True

$Results = Get-ItemProperty HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall\*

foreach ($objResult in $Results)
{
	$intRow++
	$Name = $objResult.DisplayName
	$SizeKB = $objResult.EstimatedSize
	$Version = $objResult.DisplayVersion
	$InstDate = $objResult.InstallDate
	$Vendor = $objResult.Publisher
	$Sheet.Cells.Item($intRow,1) = $Vendor
	$Sheet.Cells.Item($intRow,2) = $Name
	$Sheet.Cells.Item($intRow,3) = $Version
	$Sheet.Cells.Item($intRow,4) = $SizeKB
	$Sheet.Cells.Item($intRow,5) = $InstDate
}

$Sheet.UsedRange.EntireColumn.AutoFit()

$i = 1

$xlCellTypeLastCell = 11
$used = $Sheet.usedRange
$lastCell = $used.SpecialCells($xlCellTypeLastCell)
$row = $lastCell.row
for ($i = 1; $i -le $row; $i++)
{
	If ($Sheet.Cells.Item($i, 1).Value() -eq $Null)
	{
		$Range = $Sheet.Cells.Item($i, 1).EntireRow
		$Range.Delete()
	}
}
</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>