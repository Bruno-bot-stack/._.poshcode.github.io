
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="PoshCode - Community resources for PowerShell coders">
    <meta name="author" content="Boe Prox">
    <title>Get-Weather - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title">Get-Weather</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2011-02-15</span> by <a class="blog-post-author">Boe Prox</a>
    </p>

    <h1>Get-Weather</h1>
<h3><a href="//scripts/2508.ps1">download</a></h3>
<p>This advanced function will allow you to retrieve the current weather information for a given country/city.</p>
<pre><code class="language-posh">Function Get-Weather {
&lt;#  
.SYNOPSIS  
   Display weather data for a specific country and city.
.DESCRIPTION
   Display weather data for a specific country and city. There is a possibility for this to fail if the web service being used is unavailable.
.PARAMETER Country
    URL of the website to test access to.
.PARAMETER ListCities
    Use the currently authenticated user's credentials  
.PARAMETER City
    Used to connect via a proxy         
.NOTES  
    Name: Get-Weather
    Author: Boe Prox
    DateCreated: 15Feb2011 
.LINK http://www.webservicex.net/ws/default.aspx
.LINK http://boeprox.wordpress.com       
.EXAMPLE  
    Get-Weather -Country &quot;United States&quot; -ListCities
    
Description
------------
Returns all of the available cities that are available to retrieve weather information from.
.EXAMPLE  
    Get-Weather -Country &quot;United States&quot; -City &quot;San Francisco&quot;
    
Description
------------
Retrieves the current weather information for San Francisco

#&gt; 
[cmdletbinding(
	DefaultParameterSetName = 'Weather',
	ConfirmImpact = 'low'
)]
    Param(
        [Parameter(
            Mandatory = $True,
            Position = 0,
            ParameterSetName = '',
            ValueFromPipeline = $True)]
            [string]$Country,
        [Parameter(
            Position = 1,
            Mandatory = $False,
            ParameterSetName = 'listcities')]
            [switch]$ListCities,
        [Parameter(
            Mandatory = $False,
            ParameterSetName = '')]
            [string]$City                       
                        
        )
Begin {
    $psBoundParameters.GetEnumerator() | % {  
        Write-Verbose &quot;Parameter: $_&quot; 
        }     
    Try {
        #Make connection to known good weather service
        Write-Verbose &quot;Create web proxy connection to weather service&quot;
        $weather = New-WebServiceProxy 'http://www.webservicex.net/globalweather.asmx?WSDL'
        }
    Catch {
        Write-Warning &quot;$($Error[0])&quot;
        Break
        }        
    }
Process {
    #Determine if we are only to list the cities for a given country or get the weather from a city
    Switch ($PSCmdlet.ParameterSetName) {
        ListCities {
            Try {
                #List all cities available to query for weather
                Write-Verbose &quot;Listing cities in country: $($country)&quot;
                (([xml]$weather.GetCitiesByCountry(&quot;$country&quot;)).newdataset).table | Sort City | Select City
                Break
                }
            Catch {
                Write-Warning &quot;$($Error[0])&quot;
                Break
                }
            }
        Weather {
            Try {
                #Get the weather for the city and country
                Write-Verbose &quot;Getting weather for Country: $($country), City $($city)&quot;
                ([xml]$weather.GetWeather(&quot;$city&quot;, &quot;$country&quot;)).CurrentWeather
                }
            Catch {
                Write-Warning &quot;$($Error[0])&quot;
                }
            }
        }
    }
End {
    Write-Verbose &quot;End function, performing clean-up&quot;
    Remove-Variable city -Force
    Remove-Variable country -Force
    }   
}     
</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>