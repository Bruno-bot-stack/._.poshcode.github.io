
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Sign up for PowerShell.Slack.com">
    <meta name="author" content="Ty Lopes">
    <title>AD user support tool - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title">AD user support tool</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2013-08-30</span> by <a class="blog-post-author">Ty Lopes</a>
    </p>

    <h1>AD user support tool</h1>
<h3><a href="//scripts/4427.ps1">download</a></h3>
<p>#Created by Ty Lopes
#Aug 2013
#Support utility to speed up recurring/quick Active Directory Tasks
#unlock user account/change password/set to expire in xx number of days</p>
<pre><code class="language-posh">#Created by Ty Lopes 
#Aug 2013
#Support util to speed up re-curring/quick Active Directory Tasks
#unlock user account/change password/set to expire in xx number of days

Import-Module ActiveDirectory

#Prompt for credentials
$creds = Get-Credential

#Loop counter
$i = 1

Do
{
clear-host

#Menu
$answers = Read-host -prompt &quot;
        _______________________________________________________________
        Support Util

        a. Unlock user account
        b. change password
        c. change password and set for user to change at next logon
        d. set account to NOT change password at next logon
        e. Exit
        f. Set account to expire in XX number of days
        _______________________________________________________________

        Enter a b c d or e&quot;

$i++

if ($answers -eq &quot;a&quot;){Read-Host &quot;Enter the user account to unlock&quot; | Unlock-ADAccount -Credential $($creds)}


if ($answers -eq &quot;b&quot;){ 
    $username = Read-host -prompt &quot;Enter Username to reset users password&quot;
    $newPassword = (Read-Host -Prompt &quot;Provide New Password&quot; -AsSecureString)
    Set-ADAccountPassword -Identity $username -NewPassword $newPassword -Reset -Credential $($creds)
}

if ($answers -eq &quot;c&quot;)
{
    $username = Read-host -prompt &quot;Enter Username to reset users password&quot;
    $newPassword = (Read-Host -Prompt &quot;Provide New Password&quot; -AsSecureString)
    Set-ADAccountPassword -Identity $username -NewPassword $newPassword -Reset -Credential $($creds)
    Set-ADUser $username -ChangePasswordAtLogon $true -Credential $($creds)
} 

if ($answers -eq &quot;d&quot;)
{
    $username = Read-host -prompt &quot;Enter Username to reset users password&quot;
    Set-ADUser $username -ChangePasswordAtLogon $false -Credential $($creds)
}

if ($answers -eq &quot;f&quot;)
{
    $username = Read-host -prompt &quot;Enter Username to extend expiration&quot;
    $expires =  Read-host -prompt &quot;Enter how many days away to expire the account&quot;
    Set-adaccountExpiration $username -timespan &quot;$expires&quot; -Credential $($creds)
} 

if ($answers -eq &quot;e&quot;)
{
    $host.exit()
}
}
while ($i -le 1000)


</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>