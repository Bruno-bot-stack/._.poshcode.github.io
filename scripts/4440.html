
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="PoshCode - Community resources for PowerShell coders">
    <meta name="author" content="Fishee">
    <title>Get-RebootHistory - PoshCode</title>

    <link rel="stylesheet" href="/css/superhero.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/highlight/arta.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" id="tabs">
                    <li class="nav-item"><a class="nav-link" href="/">Join Us!</a></li>
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video">Videos</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

	<div class="container">
		<div class="blog-header">
			<h1 class="blog-title">PoshCode</h1>
			<p class="lead blog-description">Community resources for PowerShell coders</p>
		</div>
		<div class="row">
            

<div class="blog-post">
    <h2 class="blog-post-title">Get-RebootHistory</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2013-09-04</span> by <a class="blog-post-author">Fishee</a>
    </p>

    <h3>Download <a href="/scripts/4440.ps1">Get-RebootHistory.ps1</a></h3>
<p>http://www.powershellmagazine.com/2012/10/15/pstip-get-your-reboot-history/?utm_source=feedburner&amp;utm_medium=email&amp;utm_campaign=Feed%3A+PowershellMagazine+%28PowerShell+Magazine%29</p>
<pre><code class="language-powershell">function Get-RebootHistory{
    &lt;#
    .SYNOPSIS
    PSTip Get your reboot history.
    .DESCRIPTION
    Have you ever wondered how often is your station rebooted? Let’s ask the Windows Event Log and get time of last five reboots. You will use the Get-WinEvent cmdlet to connect to System event log. You are interested in “The Event log service was started.” event which has Id 6005.
    .EXAMPLE
    Get-RebootHistory

    PS C:&gt; .\Get-RebootHistory.ps1

    ComputerName          Reboots
    ------------          -------
    TEST11122             {System.Diagnostics.Eventing.Reader.EventLogRecord, Syst...


    .NOTES
    There is of course a 6006 event if you are more interested in shutdowns.
    Since operating sytstems can halt or a power failure may occur, the 1074 may not be present in the system log, making false impression nothing has happened.
    .LINK
    http://www.powershellmagazine.com/2012/10/15/pstip-get-your-reboot-history/?utm_source=feedburner&amp;utm_medium=email&amp;utm_campaign=Feed%3A+PowershellMagazine+%28PowerShell+Magazine%29
    #&gt;
    [cmdletbinding()]
    param(
        #The list of computers you want to get. The default is $env:ComputerName.
        [Parameter(Mandatory=$False,ValueFromPipeline=$true)]
        [string[]]$ComputerName=$env:COMPUTERNAME,

        #You can get 6005 or 6006. The default is 6005.
        [ValidateSet(6005,6006)]
        [int]$EventID=6005,

        #The number of events you want to get back. If none is supplied, it returns all recorded events.
        [ValidateRange(1,[uint32]::MaxValue)]
        [int]$MaxEvents=0
    )

    begin{
        $xml=@&quot;
&lt;QueryList&gt;
&lt;Query Id=&quot;0&quot; Path=&quot;System&quot;&gt;
&lt;Select Path=&quot;System&quot;&gt;*[System[(EventID=$EventID)]]&lt;/Select&gt;
&lt;/Query&gt;
&lt;/QueryList&gt;
&quot;@
    $EventArgs = @{FilterXml=$xml;ErrorAction='Stop'}
    if($MaxEvents){
        $EventArgs['MaxEvents'] = $MaxEvents
    }
}
    process{
        foreach($Computer in $ComputerName){
            try{
                Write-Output ([PSCustomObject]@{ComputerName=$Computer;Reboots=(Get-WinEvent -ComputerName $Computer @EventArgs)})
            }
            catch{
                Write-Error &quot;Could not get reboot history from '$Computer'. $($Error[0])&quot;
            }            
        }
    }
    end{}
}
</code></pre>

</div>
			<!-- sidebar? -->
		</div>
		<hr>
		<footer class="blog-footer">
			<p>Generated by Joel &quot;Jaykul&quot; Bennett - 2018</p>
		</footer>
	</div> <!-- /container -->

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>
    <script src="/js/vendor/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>