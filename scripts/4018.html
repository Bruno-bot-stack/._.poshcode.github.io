
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Sign up for PowerShell.Slack.com">
    <meta name="author" content="Denis St-Pierre">
    <title> - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title"></h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2013-03-15</span> by <a class="blog-post-author">Denis St-Pierre</a>
    </p>

    <h1></h1>
<h3><a href="//scripts/4018.ps1">download</a></h3>
<p>GUI Replacement for PowerShell's Write-Progress command
Uses same named parameters for drop-in replacement
CAVEATS: You can't close the Form by clicking on it, must call Write-ProgressForm -Completed</p>
<p>Code below is a working sample</p>
<pre><code class="language-posh">
function Write-ProgressForm {
	&lt;#
	.SYNOPSIS
		Write-ProgressForm V1.0
		GUI Replacement for PowerShell's Write-Progress command

	.DESCRIPTION
		GUI Replacement for PowerShell's Write-Progress command
		Uses same named parameters for drop-in replacement
		CAVEATS: You can't close the Form by clicking on it, must call Write-ProgressForm -Completed
				 Therefore decided to hide Close button (why tease people?)

	.INPUTS
		Same as Write-Progress command 
		BONUS:
		-ICOpath &lt;path to your ICO&gt;
		-FormTitle &lt;Title of the Write-progress form&gt; 
		(Only needs to be mentioned when 1st called then it sticks around)
		
	.OUTPUTS
		Nothing but a GUI

	.NOTES
		Uses Global variables extensively
		License: GPL v3.0 or greater / BSD (Latest version)
		Form Code Generated By: SAPIEN Technologies PrimalForms (Community Edition) v1.0.10.0
		Generated On: 30/01/2013 12:38 PM
		Generated By: Denis St-Pierre, Ottawa, Canada
	#&gt;
	
	param(	#parameters with default values assigned
		[String]$Activity=&quot;Activity&quot;,
		[String]$CurrentOperation=&quot;CurrentOperation&quot;,
		[String]$status=&quot;Status&quot;,
		[Int]$PercentComplete=0,
		[switch]$Completed=$false,
		[int]$FontSize = 10,
		[String]$ICOpath=&quot;&quot;,	#yes, you can use your *OWN* icon file in the form
		[String]$FormTitle=&quot;&quot;
		
	)
	
	$HideUselessCloseButton=$true	#Change to false if you can fix it, pls
	$UselessAutoSize=$false			#Useless because it doesn't work as expected
	
	#If WriteProgressForm variable exists, use it.
	If ( Get-Variable -Name WriteProgressForm -Scope Global -ErrorAction SilentlyContinue ) {
		If ( $Completed){	#If asked to close, do it
			$progressBar1.Value=100
			$StatusLabel.Text = &quot;Complete&quot;
			Start-Sleep -Seconds 1
			$WriteProgressForm.close()
			Return
		} else {		#otherwise, Update it
			$progressBar1.Value = $PercentComplete	#To update Progress bar position
			$ActivityLabel.Text = &quot;$Activity&quot;
			$CurrentOperationLabel.Text = &quot;$CurrentOperation&quot;
			$StatusLabel.Text = &quot;$status&quot;
			Return
		}
	}

	#region Import the Assemblies
	[reflection.assembly]::loadwithpartialname(&quot;System.Windows.Forms&quot;) | Out-Null
	[reflection.assembly]::loadwithpartialname(&quot;System.Drawing&quot;) | Out-Null
	#endregion

	#region Generated Form Objects
	$global:WriteProgressForm = New-Object System.Windows.Forms.Form
	$global:StatusLabel = New-Object System.Windows.Forms.Label
	$CloseButton = New-Object System.Windows.Forms.Button
	$global:progressBar1 = New-Object System.Windows.Forms.ProgressBar
	$global:CurrentOperationLabel = New-Object System.Windows.Forms.Label
	$global:ActivityLabel = New-Object System.Windows.Forms.Label
	$InitialFormWindowState = New-Object System.Windows.Forms.FormWindowState
	#endregion Generated Form Objects

	#----------------------------------------------
	#Generated Event Script Blocks
	#----------------------------------------------
	#Provide Custom Code for events specified in PrimalForms.
#	$WriteProgressForm.close()= 
#	{
	#TODO: Place custom script here	
#	}

	$CloseButton_OnClick= 
	{
	#TODO: Place custom script here

	}

	$OnLoadForm_StateCorrection=
	{#Correct the initial state of the form to prevent the .Net maximized form issue
		$WriteProgressForm.WindowState = $InitialFormWindowState
	}

	#----------------------------------------------
	#region Generated Form Code
	$WriteProgressForm.AccessibleDescription = &quot;WriteProgressFormDesc&quot;
	$WriteProgressForm.AccessibleName = &quot;WriteProgressForm&quot;
	$WriteProgressForm.AccessibleRole = 48
	$WriteProgressForm.AutoSize = $true		#works on forms, labels not so much
	$WriteProgressForm.AutoSizeMode = 0
	$System_Drawing_Size = New-Object System.Drawing.Size
#	$System_Drawing_Size.Height = 170
#	$System_Drawing_Size.Width = 505
#	$WriteProgressForm.ClientSize = $System_Drawing_Size
	$WriteProgressForm.DataBindings.DefaultDataSourceUpdateMode = 0
	$WriteProgressForm.StartPosition = 1 #Center of the Screen
	#add Icon to dialog, if possible
	If ( ($ICOpath -ne &quot;&quot;) -and (Test-Path &quot;$ICOpath&quot;) ) {
		Try {	#If the ICO file is NFG, ignore and move on
			$WriteProgressForm.Icon = [System.Drawing.Icon]::ExtractAssociatedIcon(&quot;$ICOpath&quot;)
		} catch { } #use default ICO
	}
	$WriteProgressForm.Name = &quot;WriteProgressForm&quot;
	$WriteProgressForm.Text = &quot;$FormTitle&quot;
#	$WriteProgressForm.add_FormClosing($WriteProgressForm.close()) #failed attempt to make CloseButton work w/o PS code

	# ** $StatusLabel
	$StatusLabel.DataBindings.DefaultDataSourceUpdateMode = 0
	$System_Drawing_Point = New-Object System.Drawing.Point
	$System_Drawing_Point.X = 15
	$System_Drawing_Point.Y = 33
	$StatusLabel.Location = $System_Drawing_Point
	$System_Drawing_Size = New-Object System.Drawing.Size
	$System_Drawing_Size.Height = 20
	$System_Drawing_Size.Width = 475
	$StatusLabel.MinimumSize = $System_Drawing_Size
	$StatusLabel.AutoSize = $UselessAutoSize
	$StatusLabel.Name = &quot;StatusLabel&quot;
	$System_Windows_Forms_Padding = New-Object System.Windows.Forms.Padding
	$System_Windows_Forms_Padding.All = 1
	$System_Windows_Forms_Padding.Bottom = 1
	$System_Windows_Forms_Padding.Left = 1
	$System_Windows_Forms_Padding.Right = 1
	$System_Windows_Forms_Padding.Top = 1
	$StatusLabel.Padding = $System_Windows_Forms_Padding
#	$System_Drawing_Size = New-Object System.Drawing.Size
#	$System_Drawing_Size.Height = 20
#	$System_Drawing_Size.Width = 475
#	$StatusLabel.Size = $System_Drawing_Size
	$StatusLabel.TabIndex = 4
	$StatusLabel.Text = &quot;$status&quot;
	
	$WriteProgressForm.Controls.Add($StatusLabel)
	
	# ** $CloseButton
	$CloseButton.DataBindings.DefaultDataSourceUpdateMode = 0
	$System_Drawing_Point = New-Object System.Drawing.Point
	$System_Drawing_Point.X = 400
	$System_Drawing_Point.Y = 134
	$CloseButton.Location = $System_Drawing_Point
	$CloseButton.Name = &quot;CloseButton&quot;
	$System_Drawing_Size = New-Object System.Drawing.Size
	$System_Drawing_Size.Height = 25
	$System_Drawing_Size.Width = 90
	$CloseButton.Size = $System_Drawing_Size
	$CloseButton.TabIndex = 3
	$CloseButton.Text = &quot;Close&quot;
	$CloseButton.UseVisualStyleBackColor = $True
	$CloseButton.add_Click($CloseButton_OnClick)
#	$CloseButton.add_MouseClick($WriteProgressForm.close()) #failed attempt #2 to make CloseButton work w/o PS code
	
	If ($HideUselessCloseButton) {
		#dont add button to form
	} else {
		$WriteProgressForm.Controls.Add($CloseButton)
	}
	
	# ** $progressBar1
	$progressBar1.DataBindings.DefaultDataSourceUpdateMode = 0
	$System_Drawing_Point = New-Object System.Drawing.Point
	$System_Drawing_Point.X = 10
	$System_Drawing_Point.Y = 57
	$progressBar1.Location = $System_Drawing_Point
	$System_Windows_Forms_Padding = New-Object System.Windows.Forms.Padding
	$System_Windows_Forms_Padding.All = 5
	$System_Windows_Forms_Padding.Bottom = 5
	$System_Windows_Forms_Padding.Left = 5
	$System_Windows_Forms_Padding.Right = 5
	$System_Windows_Forms_Padding.Top = 5
	$progressBar1.Margin = $System_Windows_Forms_Padding
	$System_Drawing_Size = New-Object System.Drawing.Size
	$System_Drawing_Size.Height = 30
	$System_Drawing_Size.Width = 480
	$progressBar1.MinimumSize = $System_Drawing_Size
	$progressBar1.AutoSize = $UselessAutoSize	#doesn't work, stays the same size
	$progressBar1.Name = &quot;progressBar1&quot;
#	$System_Drawing_Size = New-Object System.Drawing.Size
#	$System_Drawing_Size.Height = 30
#	$System_Drawing_Size.Width = 480
#	$progressBar1.Size = $System_Drawing_Size
	$progressBar1.Step = 1
	$progressBar1.Style = 1
	$progressBar1.TabIndex = 2
	$progressBar1.Value = $PercentComplete	#Progress bar position
	
	$WriteProgressForm.Controls.Add($progressBar1)
	
	# ** $CurrentOperationLabel
	$CurrentOperationLabel.AccessibleDescription = &quot;CurrentOperationDesc&quot;
	$CurrentOperationLabel.AccessibleName = &quot;CurrentOperation&quot;
	$CurrentOperationLabel.AccessibleRole = 0
	$CurrentOperationLabel.CausesValidation = $False
	$CurrentOperationLabel.DataBindings.DefaultDataSourceUpdateMode = 0
	$System_Drawing_Point = New-Object System.Drawing.Point
	$System_Drawing_Point.X = 15
	$System_Drawing_Point.Y = 100
	$CurrentOperationLabel.Location = $System_Drawing_Point
	$System_Windows_Forms_Padding = New-Object System.Windows.Forms.Padding
	$System_Windows_Forms_Padding.All = 1
	$System_Windows_Forms_Padding.Bottom = 1
	$System_Windows_Forms_Padding.Left = 1
	$System_Windows_Forms_Padding.Right = 1
	$System_Windows_Forms_Padding.Top = 1
	$CurrentOperationLabel.Margin = $System_Windows_Forms_Padding
	$System_Drawing_Size = New-Object System.Drawing.Size
	$System_Drawing_Size.Height = 20
	$System_Drawing_Size.Width = 475
	$CurrentOperationLabel.MinimumSize = $System_Drawing_Size
	$CurrentOperationLabel.AutoSize = $UselessAutoSize
	$CurrentOperationLabel.Name = &quot;CurrentOperationLabel&quot;
	$System_Windows_Forms_Padding = New-Object System.Windows.Forms.Padding
	$System_Windows_Forms_Padding.All = 1
	$System_Windows_Forms_Padding.Bottom = 1
	$System_Windows_Forms_Padding.Left = 1
	$System_Windows_Forms_Padding.Right = 1
	$System_Windows_Forms_Padding.Top = 1
	$CurrentOperationLabel.Padding = $System_Windows_Forms_Padding
#	$System_Drawing_Size = New-Object System.Drawing.Size
#	$System_Drawing_Size.Height = 20
#	$System_Drawing_Size.Width = 475
#	$CurrentOperationLabel.Size = $System_Drawing_Size
	$CurrentOperationLabel.TabIndex = 1
	$CurrentOperationLabel.Text = &quot;$CurrentOperation&quot;
	
	$WriteProgressForm.Controls.Add($CurrentOperationLabel)
	
	# ** $ActivityLabel
#	$ActivityLabel.CausesValidation = $False
	$ActivityLabel.DataBindings.DefaultDataSourceUpdateMode = 0
	$System_Drawing_Point = New-Object System.Drawing.Point
	$System_Drawing_Point.X = 10
	$System_Drawing_Point.Y = 10
	$ActivityLabel.Location = $System_Drawing_Point
	$System_Windows_Forms_Padding = New-Object System.Windows.Forms.Padding
	$System_Windows_Forms_Padding.All = 1
	$System_Windows_Forms_Padding.Bottom = 1
	$System_Windows_Forms_Padding.Left = 1
	$System_Windows_Forms_Padding.Right = 1
	$System_Windows_Forms_Padding.Top = 1
	$ActivityLabel.Margin = $System_Windows_Forms_Padding
	$System_Drawing_Size = New-Object System.Drawing.Size
	$System_Drawing_Size.Height = 20
	$System_Drawing_Size.Width = 480
	$ActivityLabel.MinimumSize = $System_Drawing_Size
	$ActivityLabel.Name = &quot;ActivityLabel&quot;
	$System_Windows_Forms_Padding = New-Object System.Windows.Forms.Padding
	$System_Windows_Forms_Padding.All = 1
	$System_Windows_Forms_Padding.Bottom = 1
	$System_Windows_Forms_Padding.Left = 1
	$System_Windows_Forms_Padding.Right = 1
	$System_Windows_Forms_Padding.Top = 1
	$ActivityLabel.Padding = $System_Windows_Forms_Padding
	$ActivityLabel.AutoSize = $UselessAutoSize
#	$System_Drawing_Size = New-Object System.Drawing.Size
#	$System_Drawing_Size.Height = 20
#	$System_Drawing_Size.Width = 480
#	$ActivityLabel.Size = $System_Drawing_Size
	$ActivityLabel.TabIndex = 0
	$ActivityLabel.Font = New-Object System.Drawing.Font(&quot;Microsoft Sans Serif&quot;,$FontSize,1,3,1)
	$ActivityLabel.Text = &quot;$Activity&quot;

	$WriteProgressForm.Controls.Add($ActivityLabel)

	#endregion Generated Form Code

	#Save the initial state of the form
	$InitialFormWindowState = $WriteProgressForm.WindowState
	#Init the OnLoad event to correct the initial state of the form
	$WriteProgressForm.add_Load($OnLoadForm_StateCorrection)
	
	#Show the Form
#	$WriteProgressForm.ShowDialog()| Out-Null #ShowDialog waits until it is closed
	$WriteProgressForm.Show()		#show form and keep on going
	$WriteProgressForm.activate()	#Make sure its on top
	Start-sleep -Milliseconds 500	#was needed to give time for form to fully draw itself
} #End Function


#Clean up global WriteProgressForm variables before 
try {
	$WriteProgressForm.close()
	Remove-Variable StatusLabel | Out-Null
	Remove-Variable CurrentOperationLabel | Out-Null
	Remove-Variable progressBar1 | Out-Null
	Remove-Variable ActivityLabel | Out-Null
	Remove-Variable WriteProgressForm
} catch {
	#go on
}

$ScopeNum=0
$Scope=0
$TotalNumScopes=100
	
#Foreach ($DHCPScope in $ObjDHCPscopes){
for ($PCcomplete=1; $PCcomplete -lt 100; $PCcomplete++) {
	$ScopeName=&quot;ScopeName&quot;
	$Scope=$Scope+1	#increment
	$CurrentOperation=&quot;*CurOp*Getting Leases from scope $ScopeName&quot;
	$Status=&quot;*Status*$PCcomplete% complete. ($Scope of $TotalNumScopes)&quot;
#	Write-Progress -Activity &quot;*Act*Building list from DHCP server ...&quot; -status $status -PercentComplete $PCcomplete -CurrentOperation &quot;$CurrentOperation&quot;
	Write-ProgressForm -Activity &quot;*Act*Building list from DHCP server ... Building list from DHCP server... Building list from DHCP server ...&quot; -status $status -PercentComplete $PCcomplete -CurrentOperation &quot;$CurrentOperation&quot;
	Start-sleep -Milliseconds 050
	
}
$PCcomplete=100
$CurrentOperation=&quot;complete&quot;
#Write-Progress -Activity &quot;Building list from DHCP server ...&quot; -PercentComplete $PCcomplete -CurrentOperation &quot;$CurrentOperation&quot; -Status &quot;$PCcomplete% complete.&quot;
Write-ProgressForm -Activity &quot;Building list from DHCP server ...&quot; -PercentComplete $PCcomplete -CurrentOperation &quot;$CurrentOperation&quot; -Status &quot;$PCcomplete% complete.&quot;
Start-sleep -seconds 1
#Write-Progress -Activity &quot;Complete&quot; -Completed -Status &quot;Complete&quot; 
Write-ProgressForm -Activity &quot;Complete&quot; -Completed -Status &quot;Complete&quot; 


</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>