<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Sign up for PowerShell.Slack.com">
    <meta name="author" content="Yves Rosius">
    <title>Set custom IP address - PoshCode</title>

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>

    <link rel="openid2.provider" href="https://openid.stackexchange.com/openid/provider">
    <link rel="openid2.local_id" href="https://openid.stackexchange.com/user/b167be35-3674-4571-8142-df1f7dcfc268">
<!--
    <link rel="openid2.provider" href="https://www.google.com/accounts/o8/ud" />
    <link rel="openid2.local_id" href="https://profiles.google.com/+JoelBennett" />
-->
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/Scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<h1>Set custom IP address</h1>
<h3><a href="//scripts/6698.ps1">download</a></h3>
<p>Set custom IP address</p>
<pre><code class="language-posh">function Set-CustomIP {

        &lt;#
    .SYNOPSIS
    Set network settings.
    .DESCRIPTION
    Set network settings.
    .EXAMPLE
    Set-CustomIP 192.168.1.123
    .PARAMETER IPAddress
    Preferred IP Address. DHCP is available to set IP with DHCP.
    .PARAMETER DefaultGateway
    Preferred Default Gateway. If no value is provided, a value is calculated.
	.PARAMETER PrimaryDNSServer
	Primary DNS server. Defaults to 8.8.8.8
	.PARAMETER SecondaryDNSServer
	Secondary DNS server. Defaults to 8.8.4.4
	.PARAMETER AddressFamily
	Currently only available in IPv4
	.PARAMETER InterfaceIndex
	Specify which interface using InterfaceIndex. Defaults to physical interface.
    #&gt;
	
    [CmdletBinding()]
    Param(
        [Parameter(Mandatory=$True, Position=1)]
        [string] $IPAddress,

        [Parameter(Mandatory=$False, Position=2)]
        [string] $DefaultGateway,

        [Parameter(Mandatory=$False, Position=3)]
        [string] $PrimaryDNSServer = &quot;8.8.8.8&quot;,

        [Parameter(Mandatory=$False, Position=4)]
        [string] $SecondaryDNSServer = &quot;8.8.4.4&quot;,
		
		[Parameter(Mandatory=$False, Position=5)]
        [string] $AddressFamily = &quot;IPv4&quot;,
		
		[Parameter(Mandatory=$False, Position=6)]
        [string] $PrefixLength = &quot;24&quot;,
		
		[Parameter(Mandatory=$False, Position=7)]
        [string] $InterfaceIndex = (Get-NetAdapter -physical).ifIndex
    )
	
	### Removes current IP settings to avoid clutter.
	Get-NetIPAddress -InterfaceIndex $InterfaceIndex -AddressFamily $AddressFamily | % {Remove-NetIPAddress $_.IPAddress -Confirm:$false} 
	Remove-NetRoute -InterfaceIndex $InterfaceIndex -Confirm:$false
	
	if ($IPAddress -eq &quot;DHCP&quot;) {
		Get-NetAdapter -InterfaceIndex $InterfaceIndex | Set-NetIPInterface -Dhcp enabled
		break
		}
	
	### If DefaultGateway not specified, calculate standard value for Default Gateway.
	if (!$DefaultGateway) {
		$IPArray = $IPAddress.split(&quot;.&quot;)
		$DefaultGateway = $IPArray[0] + &quot;.&quot; + $IPArray[1] + &quot;.&quot; + $IPArray[2] + &quot;.1&quot;
		}
	
    New-NetIPAddress `
		-InterfaceIndex $InterfaceIndex `
		-IPAddress $IPAddress `
		-DefaultGateway $DefaultGateway `
		-AddressFamily $AddressFamily `
		-PrefixLength $PrefixLength `
        -Confirm:$false
		
    Set-DnsClientServerAddress `
		-InterfaceIndex $InterfaceIndex `
		-ServerAddresses $PrimaryDNSServer, $SecondaryDNSServer

    }
</code></pre>

    <footer class="blog-footer">
        <p>Â© Joel "Jaykul" Bennett 2018.</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>