
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="PoshCode - Community resources for PowerShell coders">
    <meta name="author" content="Chad Miller">
    <title>sqlps2 - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title">sqlps2</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2010-05-27</span> by <a class="blog-post-author">Chad Miller</a>
    </p>

    <h1>sqlps2</h1>
<h3><a href="//scripts/1885.cs">download</a></h3>
<p>A C# source file created by running make-shell to create a SQL Server minishell</p>
<pre><code class="language-csharp">using System;
using System.IO;
using System.Collections;
using System.Collections.Generic;
using System.Collections.ObjectModel;
using System.Resources;
using System.Globalization;
using System.Management.Automation;
using System.Management.Automation.Runspaces;
using System.Reflection;

[assembly:RunspaceConfigurationType(&quot;Community.CustomRunspaceConfiguration&quot;)]

namespace Community
{
    /// &lt;summary&gt;
    /// CustomRunspaceConfiguration implements runspace configuration for current
    /// minishell.
    /// &lt;/summary&gt;
    public class CustomRunspaceConfiguration : RunspaceConfiguration
    {
        /// &lt;summary&gt;
        /// Constructor is made private intentionally so that each instance of 
        /// CustomRunspaceConfiguration will be created through Create() function
        /// &lt;/summary&gt;
        private CustomRunspaceConfiguration()
        {
        }

        /// &lt;summary&gt;
        /// This is the static function to create an instance of this type.
        /// &lt;/summary&gt;
        /// &lt;returns&gt;runspace configuration instance created&lt;/returns&gt;
        public new static RunspaceConfiguration Create()
        {
            CustomRunspaceConfiguration runspaceConfig = new CustomRunspaceConfiguration();

            return runspaceConfig;
        }

        private const string _shellId = &quot;Community.sqlps2&quot;;

        /// &lt;summary&gt;
        /// Shell Id
        /// &lt;/summary&gt;
        /// &lt;value&gt;Shell Id&lt;/value&gt;
        public override string ShellId
        {
            get
            {
                return _shellId;
            }
        }

        #region Cmdlets, Providers, Assemblies
        
        private CmdletConfigurationEntry[] _cmdletConfigurationEntries = new CmdletConfigurationEntry[] { new CmdletConfigurationEntry(&quot;Invoke-Sqlcmd&quot;, typeof(Microsoft.SqlServer.Management.PowerShell.GetScriptCommand), &quot;Microsoft.SqlServer.Management.PSSnapins.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Invoke-PolicyEvaluation&quot;, typeof(Microsoft.SqlServer.Management.PowerShell.InvokePolicyEvaluationCommand), &quot;Microsoft.SqlServer.Management.PSSnapins.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Encode-SqlName&quot;, typeof(Microsoft.SqlServer.Management.PowerShell.EncodeSqlName), &quot;Microsoft.SqlServer.Management.PSProvider.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Decode-SqlName&quot;, typeof(Microsoft.SqlServer.Management.PowerShell.DecodeSqlName), &quot;Microsoft.SqlServer.Management.PSProvider.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Convert-UrnToPath&quot;, typeof(Microsoft.SqlServer.Management.PowerShell.ConvertUrnToPath), &quot;Microsoft.SqlServer.Management.PSProvider.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Start-Transcript&quot;, typeof(Microsoft.PowerShell.Commands.StartTranscriptCommand), &quot;Microsoft.PowerShell.ConsoleHost.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Stop-Transcript&quot;, typeof(Microsoft.PowerShell.Commands.StopTranscriptCommand), &quot;Microsoft.PowerShell.ConsoleHost.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-Command&quot;, typeof(Microsoft.PowerShell.Commands.GetCommandCommand), &quot;System.Management.Automation.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-Help&quot;, typeof(Microsoft.PowerShell.Commands.GetHelpCommand), &quot;System.Management.Automation.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-History&quot;, typeof(Microsoft.PowerShell.Commands.GetHistoryCommand), &quot;System.Management.Automation.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Invoke-History&quot;, typeof(Microsoft.PowerShell.Commands.InvokeHistoryCommand), &quot;System.Management.Automation.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Add-History&quot;, typeof(Microsoft.PowerShell.Commands.AddHistoryCommand), &quot;System.Management.Automation.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;ForEach-Object&quot;, typeof(Microsoft.PowerShell.Commands.ForEachObjectCommand), &quot;System.Management.Automation.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Where-Object&quot;, typeof(Microsoft.PowerShell.Commands.WhereObjectCommand), &quot;System.Management.Automation.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Set-PSDebug&quot;, typeof(Microsoft.PowerShell.Commands.SetPSDebugCommand), &quot;System.Management.Automation.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Add-Content&quot;, typeof(Microsoft.PowerShell.Commands.AddContentCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Clear-Content&quot;, typeof(Microsoft.PowerShell.Commands.ClearContentCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Clear-ItemProperty&quot;, typeof(Microsoft.PowerShell.Commands.ClearItemPropertyCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Join-Path&quot;, typeof(Microsoft.PowerShell.Commands.JoinPathCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Convert-Path&quot;, typeof(Microsoft.PowerShell.Commands.ConvertPathCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Copy-ItemProperty&quot;, typeof(Microsoft.PowerShell.Commands.CopyItemPropertyCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-EventLog&quot;, typeof(Microsoft.PowerShell.Commands.GetEventLogCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-ChildItem&quot;, typeof(Microsoft.PowerShell.Commands.GetChildItemCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-Content&quot;, typeof(Microsoft.PowerShell.Commands.GetContentCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-ItemProperty&quot;, typeof(Microsoft.PowerShell.Commands.GetItemPropertyCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-WmiObject&quot;, typeof(Microsoft.PowerShell.Commands.GetWmiObjectCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Move-ItemProperty&quot;, typeof(Microsoft.PowerShell.Commands.MoveItemPropertyCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-Location&quot;, typeof(Microsoft.PowerShell.Commands.GetLocationCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Set-Location&quot;, typeof(Microsoft.PowerShell.Commands.SetLocationCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Push-Location&quot;, typeof(Microsoft.PowerShell.Commands.PushLocationCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Pop-Location&quot;, typeof(Microsoft.PowerShell.Commands.PopLocationCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;New-PSDrive&quot;, typeof(Microsoft.PowerShell.Commands.NewPSDriveCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Remove-PSDrive&quot;, typeof(Microsoft.PowerShell.Commands.RemovePSDriveCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-PSDrive&quot;, typeof(Microsoft.PowerShell.Commands.GetPSDriveCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-Item&quot;, typeof(Microsoft.PowerShell.Commands.GetItemCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;New-Item&quot;, typeof(Microsoft.PowerShell.Commands.NewItemCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Set-Item&quot;, typeof(Microsoft.PowerShell.Commands.SetItemCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Remove-Item&quot;, typeof(Microsoft.PowerShell.Commands.RemoveItemCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Move-Item&quot;, typeof(Microsoft.PowerShell.Commands.MoveItemCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Rename-Item&quot;, typeof(Microsoft.PowerShell.Commands.RenameItemCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Copy-Item&quot;, typeof(Microsoft.PowerShell.Commands.CopyItemCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Clear-Item&quot;, typeof(Microsoft.PowerShell.Commands.ClearItemCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Invoke-Item&quot;, typeof(Microsoft.PowerShell.Commands.InvokeItemCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-PSProvider&quot;, typeof(Microsoft.PowerShell.Commands.GetPSProviderCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;New-ItemProperty&quot;, typeof(Microsoft.PowerShell.Commands.NewItemPropertyCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Split-Path&quot;, typeof(Microsoft.PowerShell.Commands.SplitPathCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Test-Path&quot;, typeof(Microsoft.PowerShell.Commands.TestPathCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-Process&quot;, typeof(Microsoft.PowerShell.Commands.GetProcessCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Stop-Process&quot;, typeof(Microsoft.PowerShell.Commands.StopProcessCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Remove-ItemProperty&quot;, typeof(Microsoft.PowerShell.Commands.RemoveItemPropertyCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Rename-ItemProperty&quot;, typeof(Microsoft.PowerShell.Commands.RenameItemPropertyCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Resolve-Path&quot;, typeof(Microsoft.PowerShell.Commands.ResolvePathCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-Service&quot;, typeof(Microsoft.PowerShell.Commands.GetServiceCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Stop-Service&quot;, typeof(Microsoft.PowerShell.Commands.StopServiceCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Start-Service&quot;, typeof(Microsoft.PowerShell.Commands.StartServiceCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Suspend-Service&quot;, typeof(Microsoft.PowerShell.Commands.SuspendServiceCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Resume-Service&quot;, typeof(Microsoft.PowerShell.Commands.ResumeServiceCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Restart-Service&quot;, typeof(Microsoft.PowerShell.Commands.RestartServiceCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Set-Service&quot;, typeof(Microsoft.PowerShell.Commands.SetServiceCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;New-Service&quot;, typeof(Microsoft.PowerShell.Commands.NewServiceCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Set-Content&quot;, typeof(Microsoft.PowerShell.Commands.SetContentCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Set-ItemProperty&quot;, typeof(Microsoft.PowerShell.Commands.SetItemPropertyCommand), &quot;Microsoft.PowerShell.Commands.Management.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Format-Default&quot;, typeof(Microsoft.PowerShell.Commands.FormatDefaultCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Format-List&quot;, typeof(Microsoft.PowerShell.Commands.FormatListCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Format-Custom&quot;, typeof(Microsoft.PowerShell.Commands.FormatCustomCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Format-Table&quot;, typeof(Microsoft.PowerShell.Commands.FormatTableCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Format-Wide&quot;, typeof(Microsoft.PowerShell.Commands.FormatWideCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Out-Null&quot;, typeof(Microsoft.PowerShell.Commands.OutNullCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Out-Default&quot;, typeof(Microsoft.PowerShell.Commands.OutDefaultCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Out-Host&quot;, typeof(Microsoft.PowerShell.Commands.OutHostCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Out-File&quot;, typeof(Microsoft.PowerShell.Commands.OutFileCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Out-Printer&quot;, typeof(Microsoft.PowerShell.Commands.OutPrinterCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Out-String&quot;, typeof(Microsoft.PowerShell.Commands.OutStringCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Out-LineOutput&quot;, typeof(Microsoft.PowerShell.Commands.OutLineOutputCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Add-Member&quot;, typeof(Microsoft.PowerShell.Commands.AddMemberCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Compare-Object&quot;, typeof(Microsoft.PowerShell.Commands.CompareObjectCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;ConvertTo-Html&quot;, typeof(Microsoft.PowerShell.Commands.ConvertToHtmlCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Export-Csv&quot;, typeof(Microsoft.PowerShell.Commands.ExportCsvCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Import-Csv&quot;, typeof(Microsoft.PowerShell.Commands.ImportCsvCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Export-Alias&quot;, typeof(Microsoft.PowerShell.Commands.ExportAliasCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Invoke-Expression&quot;, typeof(Microsoft.PowerShell.Commands.InvokeExpressionCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-Alias&quot;, typeof(Microsoft.PowerShell.Commands.GetAliasCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-Culture&quot;, typeof(Microsoft.PowerShell.Commands.GetCultureCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-Date&quot;, typeof(Microsoft.PowerShell.Commands.GetDateCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-Host&quot;, typeof(Microsoft.PowerShell.Commands.GetHostCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-Member&quot;, typeof(Microsoft.PowerShell.Commands.GetMemberCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-UICulture&quot;, typeof(Microsoft.PowerShell.Commands.GetUICultureCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-Unique&quot;, typeof(Microsoft.PowerShell.Commands.GetUniqueCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Import-Alias&quot;, typeof(Microsoft.PowerShell.Commands.ImportAliasCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Select-String&quot;, typeof(Microsoft.PowerShell.Commands.SelectStringCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Measure-Object&quot;, typeof(Microsoft.PowerShell.Commands.MeasureObjectCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;New-Alias&quot;, typeof(Microsoft.PowerShell.Commands.NewAliasCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;New-TimeSpan&quot;, typeof(Microsoft.PowerShell.Commands.NewTimeSpanCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Read-Host&quot;, typeof(Microsoft.PowerShell.Commands.ReadHostCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Set-Alias&quot;, typeof(Microsoft.PowerShell.Commands.SetAliasCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Set-Date&quot;, typeof(Microsoft.PowerShell.Commands.SetDateCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Start-Sleep&quot;, typeof(Microsoft.PowerShell.Commands.StartSleepCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Tee-Object&quot;, typeof(Microsoft.PowerShell.Commands.TeeObjectCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Measure-Command&quot;, typeof(Microsoft.PowerShell.Commands.MeasureCommandCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Update-TypeData&quot;, typeof(Microsoft.PowerShell.Commands.UpdateTypeDataCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Update-FormatData&quot;, typeof(Microsoft.PowerShell.Commands.UpdateFormatDataCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Write-Host&quot;, typeof(Microsoft.PowerShell.Commands.WriteHostCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Write-Progress&quot;, typeof(Microsoft.PowerShell.Commands.WriteProgressCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;New-Object&quot;, typeof(Microsoft.PowerShell.Commands.NewObjectCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Select-Object&quot;, typeof(Microsoft.PowerShell.Commands.SelectObjectCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Group-Object&quot;, typeof(Microsoft.PowerShell.Commands.GroupObjectCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Sort-Object&quot;, typeof(Microsoft.PowerShell.Commands.SortObjectCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-Variable&quot;, typeof(Microsoft.PowerShell.Commands.GetVariableCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;New-Variable&quot;, typeof(Microsoft.PowerShell.Commands.NewVariableCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Set-Variable&quot;, typeof(Microsoft.PowerShell.Commands.SetVariableCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Remove-Variable&quot;, typeof(Microsoft.PowerShell.Commands.RemoveVariableCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Clear-Variable&quot;, typeof(Microsoft.PowerShell.Commands.ClearVariableCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Export-Clixml&quot;, typeof(Microsoft.PowerShell.Commands.ExportClixmlCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Import-Clixml&quot;, typeof(Microsoft.PowerShell.Commands.ImportClixmlCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Write-Debug&quot;, typeof(Microsoft.PowerShell.Commands.WriteDebugCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Write-Verbose&quot;, typeof(Microsoft.PowerShell.Commands.WriteVerboseCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Write-Warning&quot;, typeof(Microsoft.PowerShell.Commands.WriteWarningCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Write-Error&quot;, typeof(Microsoft.PowerShell.Commands.WriteErrorCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Write-Output&quot;, typeof(Microsoft.PowerShell.Commands.WriteOutputCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-TraceSource&quot;, typeof(Microsoft.PowerShell.Commands.GetTraceSourceCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Set-TraceSource&quot;, typeof(Microsoft.PowerShell.Commands.SetTraceSourceCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Trace-Command&quot;, typeof(Microsoft.PowerShell.Commands.TraceCommandCommand), &quot;Microsoft.PowerShell.Commands.Utility.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-Acl&quot;, typeof(Microsoft.PowerShell.Commands.GetAclCommand), &quot;Microsoft.PowerShell.Security.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Set-Acl&quot;, typeof(Microsoft.PowerShell.Commands.SetAclCommand), &quot;Microsoft.PowerShell.Security.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-PfxCertificate&quot;, typeof(Microsoft.PowerShell.Commands.GetPfxCertificateCommand), &quot;Microsoft.PowerShell.Security.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-Credential&quot;, typeof(Microsoft.PowerShell.Commands.GetCredentialCommand), &quot;Microsoft.PowerShell.Security.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-ExecutionPolicy&quot;, typeof(Microsoft.PowerShell.Commands.GetExecutionPolicyCommand), &quot;Microsoft.PowerShell.Security.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Set-ExecutionPolicy&quot;, typeof(Microsoft.PowerShell.Commands.SetExecutionPolicyCommand), &quot;Microsoft.PowerShell.Security.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Get-AuthenticodeSignature&quot;, typeof(Microsoft.PowerShell.Commands.GetAuthenticodeSignatureCommand), &quot;Microsoft.PowerShell.Security.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;Set-AuthenticodeSignature&quot;, typeof(Microsoft.PowerShell.Commands.SetAuthenticodeSignatureCommand), &quot;Microsoft.PowerShell.Security.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;ConvertFrom-SecureString&quot;, typeof(Microsoft.PowerShell.Commands.ConvertFromSecureStringCommand), &quot;Microsoft.PowerShell.Security.dll-Help.xml&quot;), 
            new CmdletConfigurationEntry(&quot;ConvertTo-SecureString&quot;, typeof(Microsoft.PowerShell.Commands.ConvertToSecureStringCommand), &quot;Microsoft.PowerShell.Security.dll-Help.xml&quot;) };

        private RunspaceConfigurationEntryCollection&lt;CmdletConfigurationEntry&gt; _cmdlets;

        /// &lt;summary&gt;
        /// Cmdlets for this minishell
        /// &lt;/summary&gt;
        /// &lt;value&gt;a collection of cmdlet configuration entries&lt;/value&gt;
        public override RunspaceConfigurationEntryCollection&lt;CmdletConfigurationEntry&gt; Cmdlets
        {
            get
            {
                if (_cmdlets == null)
                {
                    _cmdlets = new RunspaceConfigurationEntryCollection&lt;CmdletConfigurationEntry&gt;(_cmdletConfigurationEntries);
                }

                return _cmdlets;
            }
        }

        private ProviderConfigurationEntry[] _providerConfigurationEntries = new ProviderConfigurationEntry[] { new ProviderConfigurationEntry(&quot;SqlServer&quot;, typeof(Microsoft.SqlServer.Management.PowerShell.SqlServerProvider), &quot;Microsoft.SqlServer.Management.PSProvider.dll-Help.xml&quot;), 
            new ProviderConfigurationEntry(&quot;Alias&quot;, typeof(Microsoft.PowerShell.Commands.AliasProvider), &quot;System.Management.Automation.dll-Help.xml&quot;), 
            new ProviderConfigurationEntry(&quot;Environment&quot;, typeof(Microsoft.PowerShell.Commands.EnvironmentProvider), &quot;System.Management.Automation.dll-Help.xml&quot;), 
            new ProviderConfigurationEntry(&quot;FileSystem&quot;, typeof(Microsoft.PowerShell.Commands.FileSystemProvider), &quot;System.Management.Automation.dll-Help.xml&quot;), 
            new ProviderConfigurationEntry(&quot;Function&quot;, typeof(Microsoft.PowerShell.Commands.FunctionProvider), &quot;System.Management.Automation.dll-Help.xml&quot;), 
            new ProviderConfigurationEntry(&quot;Registry&quot;, typeof(Microsoft.PowerShell.Commands.RegistryProvider), &quot;System.Management.Automation.dll-Help.xml&quot;), 
            new ProviderConfigurationEntry(&quot;Variable&quot;, typeof(Microsoft.PowerShell.Commands.VariableProvider), &quot;System.Management.Automation.dll-Help.xml&quot;), 
            new ProviderConfigurationEntry(&quot;Certificate&quot;, typeof(Microsoft.PowerShell.Commands.CertificateProvider), &quot;Microsoft.PowerShell.Security.dll-Help.xml&quot;) };

        private RunspaceConfigurationEntryCollection&lt;ProviderConfigurationEntry&gt; _providers;

        /// &lt;summary&gt;
        /// Providers for this minishell
        /// &lt;/summary&gt;
        /// &lt;value&gt;a collection of provider configuration entries&lt;/value&gt;
        public override RunspaceConfigurationEntryCollection&lt;ProviderConfigurationEntry&gt; Providers
        {
            get
            {
                if (_providers == null)
                {
                    _providers = new RunspaceConfigurationEntryCollection&lt;ProviderConfigurationEntry&gt;(_providerConfigurationEntries);
                }

                return _providers;
            }
        }

        private AssemblyConfigurationEntry[] _assemblyConfigurationEntries = new AssemblyConfigurationEntry[] { new AssemblyConfigurationEntry(&quot;Microsoft.SqlServer.Management.PSSnapins, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91&quot;, &quot;Microsoft.SqlServer.Management.PSSnapins.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.SqlServer.Management.PSProvider, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91&quot;, &quot;Microsoft.SqlServer.Management.PSProvider.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.SqlServer.Smo, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91&quot;, &quot;Microsoft.SqlServer.Smo.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.SqlServer.Dmf, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91&quot;, &quot;Microsoft.SqlServer.Dmf.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.SqlServer.SqlWmiManagement, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91&quot;, &quot;Microsoft.SqlServer.SqlWmiManagement.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.SqlServer.ConnectionInfo, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91&quot;, &quot;Microsoft.SqlServer.ConnectionInfo.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.SqlServer.SmoExtended, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91&quot;, &quot;Microsoft.SqlServer.SmoExtended.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.SqlServer.Management.Sdk.Sfc, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91&quot;, &quot;Microsoft.SqlServer.Management.Sdk.Sfc.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.SqlServer.SqlEnum, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91&quot;, &quot;Microsoft.SqlServer.SqlEnum.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.SqlServer.RegSvrEnum, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91&quot;, &quot;Microsoft.SqlServer.RegSvrEnum.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.SqlServer.WmiEnum, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91&quot;, &quot;Microsoft.SqlServer.WmiEnum.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.SqlServer.ServiceBrokerEnum, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91&quot;, &quot;Microsoft.SqlServer.ServiceBrokerEnum.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.SqlServer.ConnectionInfoExtended, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91&quot;, &quot;Microsoft.SqlServer.ConnectionInfoExtended.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.SqlServer.Management.Collector, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91&quot;, &quot;Microsoft.SqlServer.Management.Collector.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.SqlServer.Management.CollectorEnum, Version=10.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91&quot;, &quot;Microsoft.SqlServer.Management.CollectorEnum.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.PowerShell.ConsoleHost, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;, &quot;Microsoft.PowerShell.ConsoleHost.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;System.Management.Automation, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;, &quot;System.Management.Automation.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.PowerShell.Commands.Management, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;, &quot;Microsoft.PowerShell.Commands.Management.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.PowerShell.Commands.Utility, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;, &quot;Microsoft.PowerShell.Commands.Utility.dll&quot;), 
            new AssemblyConfigurationEntry(&quot;Microsoft.PowerShell.Security, Version=1.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35&quot;, &quot;Microsoft.PowerShell.Security.dll&quot;) };

        private RunspaceConfigurationEntryCollection&lt;AssemblyConfigurationEntry&gt; _assemblies;

        /// &lt;summary&gt;
        /// Type resolution assemblies for this minishell
        /// &lt;/summary&gt;
        /// &lt;value&gt;a collection of assembly configuration entries&lt;/value&gt;
        public override RunspaceConfigurationEntryCollection&lt;AssemblyConfigurationEntry&gt; Assemblies
        {
            get
            {
                if (_assemblies == null)
                {
                    _assemblies = new RunspaceConfigurationEntryCollection&lt;AssemblyConfigurationEntry&gt;(_assemblyConfigurationEntries);
                }

                return _assemblies;
            }
        }

        #endregion

        #region Types and Formats
        
        private TypeConfigurationEntry[] _typeConfigurationEntries = new TypeConfigurationEntry[] { new TypeConfigurationEntry(@&quot;SQLProvider.Types.ps1xml&quot;), new TypeConfigurationEntry(@&quot;types.ps1xml&quot;) };

        private RunspaceConfigurationEntryCollection&lt;TypeConfigurationEntry&gt; _types;

        /// &lt;summary&gt;
        /// Types for this minishell
        /// &lt;/summary&gt;
        /// &lt;value&gt;a collection of type configuration entries&lt;/value&gt;
        public override RunspaceConfigurationEntryCollection&lt;TypeConfigurationEntry&gt; Types
        {
            get
            {
                if (_types == null)
                {
                    _types = new RunspaceConfigurationEntryCollection&lt;TypeConfigurationEntry&gt;(_typeConfigurationEntries);
                }

                return _types;
            }
        }

        private FormatConfigurationEntry[] _formatConfigurationEntries = new FormatConfigurationEntry[] { new FormatConfigurationEntry(@&quot;SQLProvider.Format.ps1xml&quot;), new FormatConfigurationEntry(@&quot;DotNetTypes.format.ps1xml&quot;), new FormatConfigurationEntry(@&quot;PowerShellCore.format.ps1xml&quot;), new FormatConfigurationEntry(@&quot;PowerShellTrace.format.ps1xml&quot;), new FormatConfigurationEntry(@&quot;FileSystem.format.ps1xml&quot;), new FormatConfigurationEntry(@&quot;Registry.format.ps1xml&quot;), new FormatConfigurationEntry(@&quot;Certificate.format.ps1xml&quot;), new FormatConfigurationEntry(@&quot;Help.format.ps1xml&quot;) };

        private RunspaceConfigurationEntryCollection&lt;FormatConfigurationEntry&gt; _formats;

        /// &lt;summary&gt;
        /// Formats for this minishell
        /// &lt;/summary&gt;
        /// &lt;value&gt;a collection of format configuration entries&lt;/value&gt;
        public override RunspaceConfigurationEntryCollection&lt;FormatConfigurationEntry&gt; Formats
        {
            get
            {
                if (_formats == null)
                {
                    _formats = new RunspaceConfigurationEntryCollection&lt;FormatConfigurationEntry&gt;(_formatConfigurationEntries);
                }

                return _formats;
            }
        }

        #endregion

        

        #region scripts and initscript

        private RunspaceConfigurationEntryCollection&lt;ScriptConfigurationEntry&gt; _scripts;

        /// &lt;summary&gt;
        /// Pre-defined scripts for this minishell
        /// &lt;/summary&gt;
        /// &lt;value&gt;a collection of script configuration entries&lt;/value&gt;
        public override RunspaceConfigurationEntryCollection&lt;ScriptConfigurationEntry&gt; Scripts
        {
            get
            {
                if (_scripts == null)
                {
                    _scripts = new RunspaceConfigurationEntryCollection&lt;ScriptConfigurationEntry&gt;();

                    string[] scriptNames = null;
                    string[] scripts = null;

                    GetResources(ScriptResourceName, ref scriptNames, ref scripts);

                    if (scripts != null)
                    {
                        for (int i = 0; i &lt; scripts.Length; i++)
                        {
                            ScriptConfigurationEntry data = new ScriptConfigurationEntry(scriptNames[i], scripts[i]);
                            _scripts.Append(data);
                        }
                    }
                }

                return _scripts;
            }
        }

        private RunspaceConfigurationEntryCollection&lt;ScriptConfigurationEntry&gt; _initializationScripts;

        /// &lt;summary&gt;
        /// Initialization scripts to be run at minishell start up.
        /// &lt;/summary&gt;
        /// &lt;value&gt;a collection of initialization scripts&lt;/value&gt;
        public override RunspaceConfigurationEntryCollection&lt;ScriptConfigurationEntry&gt; InitializationScripts
        {
            get
            {
                if (_initializationScripts == null)
                {
                    _initializationScripts = new RunspaceConfigurationEntryCollection&lt;ScriptConfigurationEntry&gt;();

                    Dictionary&lt;string, object&gt; profile = GetResources(ProfileResourceName, CultureInfo.InvariantCulture);

                    if (profile == null)
                        return null;

                    if (profile != null &amp;&amp; profile.ContainsKey(ProfileResourceName))
                    {
                        _initializationScripts.Append(new ScriptConfigurationEntry(ProfileResourceName, (string)profile[ProfileResourceName]));
                    }
                }

                return _initializationScripts;
            }
        }

        #endregion

        #region Minishell Help

        static private string _shellHelp = null;
        static private string ShellHelp
        {
            get
            {
                if(_shellHelp == null)
                    LoadHelpResource();

                return _shellHelp;
            }
        }

        static private string _shellBanner = null;
        static private string ShellBanner
        {
            get
            {
                if(_shellBanner == null)
                    LoadHelpResource();

                return _shellBanner;
            }
        }

        static private void LoadHelpResource()
        {
            Dictionary&lt;string,object&gt; helpResources = GetResources(HelpResourceName, CultureInfo.CurrentUICulture);

            if(helpResources != null)
            {
                if(helpResources.ContainsKey(ShellHelpResourceKey))
                {
                    _shellHelp = (string) helpResources[ShellHelpResourceKey];
                }

                if(helpResources.ContainsKey(ShellBannerResourceKey))
                {
                    _shellBanner = (string) helpResources[ShellBannerResourceKey];
                }
            }

            return;
        }

        #endregion

        #region Resource Loading

        private const string ScriptResourceName = &quot;script&quot;;
        private const string ProfileResourceName = &quot;initialization&quot;;
        private const string HelpResourceName = &quot;help&quot;;
        private const string ShellHelpResourceKey = &quot;ShellHelp&quot;;
        private const string ShellBannerResourceKey = &quot;ShellBanner&quot;;
        private const string ResourceListKey = &quot;__resourceList__&quot;;

        /// &lt;summary&gt;
        /// Return all resources in ordered name/value pairs. Order of resources are 
        /// defined in resourceListKey. This will look for resources for invariant
        /// culture.
        /// &lt;/summary&gt;
        private static void GetResources(string resourceType, ref string[] names, ref string[] values)
        {
            names = null; 
            values = null;

            Dictionary&lt;string, object&gt; resources = GetResources(resourceType, CultureInfo.InvariantCulture);

            if(resources == null)
                return;

            if(!resources.ContainsKey(ResourceListKey))
            {
                return;
            }

            names = (string[])resources[ResourceListKey];

            if(names == null || names.Length == 0)
                return;

            values = new string[names.Length];

            for (int i = 0; i &lt; names.Length; i++)
            {
                values[i] = (string)resources[names[i]];
            }

            return;
        }

        /// &lt;summary&gt;
        /// Return all resources in defined in current assembly in the format of a string/object dictionary.
        /// &lt;/summary&gt;
        private static Dictionary&lt;string, object&gt; GetResources(string resourceType, CultureInfo culture)
        {
            ResourceManager resMgr = new ResourceManager(resourceType, Assembly.GetExecutingAssembly());
            if (resMgr == null)
                return null;

            ResourceSet resSet = null;
            try
            {
                resSet = resMgr.GetResourceSet(culture, true, true);
            }
            catch (MissingManifestResourceException)
            {
                return null;
            }

            if (resSet == null)
                return null;

            Dictionary&lt;string, object&gt; result = new Dictionary&lt;string, object&gt;(StringComparer.OrdinalIgnoreCase);

            IDictionaryEnumerator id = resSet.GetEnumerator();
            while (id.MoveNext())
            {
                result[(string)id.Key] = id.Value;
            }

            return result;
        }

        #endregion

        /// &lt;summary&gt;
        /// This is the main function for minishell. It will start msh console shell with 
        /// a runspace configuration instance for current minishell.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;args&quot;&gt;args to main&lt;/param&gt;
        /// &lt;returns&gt;minishell execution status&lt;/returns&gt;
        [LoaderOptimization(LoaderOptimization.MultiDomain)]
        public static int Main(string[] args)
        {
            RunspaceConfiguration configuration = Create();

            return Microsoft.PowerShell.ConsoleShell.Start(configuration, ShellBanner, ShellHelp, args);
        }
    }
}

</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>