
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Sign up for PowerShell.Slack.com">
    <meta name="author" content="chris seiter">
    <title>Powershell Only Outlook - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title">Powershell Only Outlook</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2011-05-26</span> by <a class="blog-post-author">chris seiter</a>
    </p>

    <h1>Powershell Only Outlook</h1>
<h3><a href="//scripts/2695.ps1">download</a></h3>
<p>My first contribution.  I am crazily thinking of doing a &quot;Powershell Only&quot; day.  The first task is to figure out how to manipulate Outlook through PowerShell.  The submitted script hits my Outlook inbox and goes through the inbox and each subfolder and retrieves the unread emails from it.  It then goes through my task list and gets all the incomplete tasks.  This was my first time using a status bar and definitely the first for making anything outside the scripting games public.  I'd hate to get finished with the Outlook &quot;module&quot; and find out I could have saved myself a lot of time, so I through the script as it is now on the mercy of the court.  Proceed with your red pens...</p>
<pre><code class="language-posh">#connect to outlook
$GetOutlook = New-Object -com &quot;Outlook.Application&quot;; 
$olName = $GetOutlook.GetNamespace(&quot;MAPI&quot;)
$olxEmailFolder = $olName.GetDefaultFolder(‘olFolderInbox’)
$olxEmailFolder.Name
$olxEmailItem = $olxemailFolder.items
#show unread emails in inbox
$olxEmailItem | ?{$_.Unread -eq $True} | select SentOn, SenderName, Subject, Body | Format-Table -auto
#go through each subfolder and get name
$SubFolders = $olxEmailFolder.Folders
ForEach($Folder in $SubFolders)
{
	$Folder.Name
	$SubfolderItem = $Folder.Items
	$EmailCount = 1
#create status bar for each subfolder
	ForEach($Email in $SubfolderItem)
	{
		Do
		{
			Write-Progress -Activity &quot;Checking folder&quot; -status $Folder.Name -

PercentComplete ($EmailCount/$Folder.Items.Count*100)
			$EmailCount++
		}
#show unread emails from subfolders
		While($EmailCount -le $Folders.Item.Count)
	$Email | ?{$_.Unread -eq $True} | select SentOn, SenderName, Subject, Body | Format-Table -

Auto
	}
}
#connect to tasks
$olxTasksFolder = $olName.GetDefaultFolder(‘olFolderTasks’)
$olxTaskItems = $olxTasksFolder.items
$TaskCount = 1
#create task array
$TaskList = @()
ForEach($TaskItem in $olxTaskItems)
{
#create status bar for tasks
	Do
	{
		Write-Progress -Activity &quot;Checking&quot; -status &quot;Tasks&quot; -PercentComplete ($Taskcount/

$olxTasksFolder.Items.count*100)
		$TaskCount++
	}
#add each incomplete tash to array
	While($TaskCount -le $olxTaskFolder.Items.Count)
	If($TaskItem.Complete -eq $False)
	{
	$TaskList+=New-Object -TypeName PSObject -Property @{
	Subject=$TaskItem.Subject
	DateCreated=$TaskItem.CreationTime
	Percent=$TaskItem.PercentComplete
	Due=$TaskItem.DueDate
	}}
}
#show task array to screen
$TaskList | Sort DueDate -descending | Format-Table -Auto
</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>