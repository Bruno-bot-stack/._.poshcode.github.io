
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="PoshCode - Community resources for PowerShell coders">
    <meta name="author" content="Paul Kiri">
    <title>Monitor-FileSize - PoshCode</title>

    <link rel="stylesheet" href="/css/superhero.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <link rel="stylesheet" href="/css/highlight/arta.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" id="tabs">
                    <li class="nav-item"><a class="nav-link" href="/">Join Us!</a></li>
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video">Videos</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

	<div class="container">
		<div class="blog-header">
			<h1 class="blog-title">PoshCode</h1>
			<p class="lead blog-description">Community resources for PowerShell coders</p>
		</div>
		<div class="row">
            

<div class="blog-post">
    <h2 class="blog-post-title">Monitor-FileSize</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2012-08-10</span> by <a class="blog-post-author">Paul Kiri</a>
    </p>

    <h3><a href="/scripts/3563.ps1">download Monitor-FileSize.ps1</a></h3>
<p>This function/script monitors the size of a file and all of its sub-directories.  It can also monitor one specific file but the user must specifiy the exact path in that case.  Usefull for making sure that disk space on a server doesn't fill up unexpectedly.</p>
<pre><code class="language-powershell">function Monitor-FileSize
{

&lt;#

.Synopsis
    Checks the file size of a given file until it reaches the specified size
.Description
    Checks the file size of a given file until it reaches the specified size.  AT that point, it alerts the user as to what the original file-size-boundry was and what it currently is.  The interval at which the script runs can be specified by the user.
.Parameter FilePath
    Path of the file that will be monitored.  If not pointed to a specific file, the script will montior all sub-directories as well.  ie. if pointed to C:\ drive, will monitor ALL files on C:\ drive
.Parameter Size
    File size is monitored against this value. When file size is equal or greater than this value, user alert is triggered.  Enter size constraints as integer values (ex: -Size 100 NOT -Size 100kb)
.Parameter Interval
    The wait interval between the executions of the function. The value of this parameter is in seconds and default value is 5 seconds
.Example
    Monitor-FileSize -FilePath C:\Test -Size 100
    
    Returns a message to the user alerting them when at least 100kb worth of memory is stored in the selected location.
.Example
    Monitor-FileSize -FilePath C:\Test -Size 100 -Interval 20
    
    Checking the size of the file and all sub-directories every 20 seconds
.Notes
    This script cannot be run as a background job and so must have a separate PowerShell window on which it can be running.

	Author: Paul Kiri.
#&gt;

param
(
[Parameter(mandatory=$true,position=0)]
[string[]]$FilePath
,
[Parameter(mandatory=$true,position=1)]
[int]$Size
,
[Parameter(mandatory=$false)]
[int]$Interval=5
)
if((Test-Path $FilePath))
{
   While($FS -le $Size)
   {
      Start-Sleep -Seconds $Interval
      $FileSize = get-childitem $FilePath -Recurse -Include *.* | foreach-object -Process { $_.length / 1024 } | Measure-Object -Sum | Select-Object -Property Sum
      $FS = $FileSize.Sum
   }
} #end if Test-Path

else{&quot;File does not exist!&quot;}

Write-Output &quot;The files at location, $FilePath , have exceeded $Size kb and are now $('{0:N4}' -f $FileSize.Sum) kb in size.&quot;


}
</code></pre>

</div>
			<!-- sidebar? -->
		</div>
		<hr>
		<footer class="blog-footer">
			<p>Generated by Joel &quot;Jaykul&quot; Bennett - 2018</p>
		</footer>
	</div> <!-- /container -->

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>
    <script src="/js/vendor/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>