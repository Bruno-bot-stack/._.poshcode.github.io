
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Sign up for PowerShell.Slack.com">
    <meta name="author" content="Rich Kusak">
    <title>New-PemFile - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title">New-PemFile</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2011-11-30</span> by <a class="blog-post-author">Rich Kusak</a>
    </p>

    <h1>New-PemFile</h1>
<h3><a href="//scripts/3075.ps1">download</a></h3>
<p>The New-PemFile function creates a new PEM file by using the content from certificate files.
CER, CRT, and KEY files are the most common certificate file types.</p>
<pre><code class="language-posh">function New-PemFile {
&lt;#
	.SYNOPSIS
		Creates a new PEM file from one or more certificate files.

	.DESCRIPTION
		The New-PemFile function creates a new PEM file by using the content from certificate files.
		CER, CRT, and KEY files are the most common certificate file types.

	.PARAMETER Path
		The path or paths to certificate files from which to create the PEM file.

	.PARAMETER Target
		Specifies the full path to the target PEM file.

	.EXAMPLE
		New-PemFile -Path C:\temp\domain.crt -Target C:\temp\domain.pem
		Creates a PEM file from a single CRT file.

	.EXAMPLE
		New-PemFile -Path C:\temp\domain.crt, C:\temp\intermediate.crt, C:\temp\root.crt -Target C:\temp\domain.pem
		Creates a PEM file from three CRT files.
		
	.EXAMPLE
		$files = dir C:\temp\*.crt
		$files[2,0,1] | New-PemFile -Target C:\temp\domain.pem
		Captures all the CRT files in the temp folder, orders the files for input into the function, and creates the PEM file.
		

	.INPUTS
		System.String

	.OUTPUTS
		None

	.NOTES
		Name: New-PemFile
		Author: Rich Kusak
		Created: 2011-11-05
		LastEdit: 2011-11-30 09:46
		Version: 1.0.1.0

	.LINK
		http://en.wikipedia.org/wiki/X.509

	.LINK
		http://www.digicert.com/ssl-support/pem-ssl-creation.htm

#&gt;

	[CmdletBinding()]
	param (
		[Parameter(Position=0, Mandatory=$true, ValueFromPipeline=$true, ValueFromPipelineByPropertyName=$true)]
		[ValidateScript({
			foreach ($file in $_) {
				if (Test-Path -LiteralPath $file) {$true} else {
					throw &quot;The argument '$_' is not a valid file.&quot;
				}
			}
		})]
		[Alias('FullName')]
		[string[]]$Path,
		
		[Parameter(Position=1, Mandatory=$true, ValueFromPipelineByPropertyName=$true)]
		[ValidatePattern('\.pem$')]
		[string]$Target
	)
	
	begin {
	
		New-Item $Target -ItemType File -Force | Out-Null
	}
	
	process {
	
		[PSObject[]]$paths += $Path
	}

	end {
	
		foreach ($file in $paths) {
			Get-Content $file | Out-File $Target -Encoding ASCII -Append
		}
	}
} # function New-PemFile

</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>