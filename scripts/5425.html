
<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Sign up for PowerShell.Slack.com">
    <meta name="author" content="greg zakharov">
    <title>junction - PoshCode</title>

    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<div class="blog-post">
    <h2 class="blog-post-title">junction</h2>
    <p class="blog-post-meta">
        <span class="blog-post-time">2014-09-14</span> by <a class="blog-post-author">greg zakharov</a>
    </p>

    <h1>junction</h1>
<h3><a href="//scripts/5425.ps1">download</a></h3>
<p>It's so strange but Sysinternals junction utility doesn't work((
See .DESCRIPTION for more details.</p>
<pre><code class="language-posh">#requires -version 2.0
Set-Alias junction Set-JunctionPoint

$script:ini = @'
[.ShellClassInfo]
CLSID2={0AFACED1-E828-11D1-9187-B532F1E9575D}
'@

function Set-JunctionPoint {
  &lt;#
    .SYNOPSIS
        Create junction point for specified directory.
    .DESCRIPTION
        This technique works well on Win2k3 system and has not been tested
        on higher versions of Windows systems (if it works then let me know
        please).
    .EXAMPLE
        PS C:\&gt; junction C:\junction &quot;D:\Documents and Settings\User\Images&quot;
    .NOTES
        Author: greg zakharov
  #&gt;
  param(
    [Parameter(Mandatory=$true, Position=0)]
    [ValidateScript({-not (Test-Path $_)})]
    [String]$JunctionPoint,
    
    [Parameter(Mandatory=$true, Position=1)]
    [ValidateScript({Test-Path $_})]
    [String]$TargetFolder
  )
  
  begin {
    function Add-File([String]$File) {
      return (Join-Path $JunctionPoint $File)
    }
  }
  process {
    [void](ni $JunctionPoint -Type Directory)
    if (!(Test-Path $JunctionPoint)) {
      Write-Warning &quot;could not create junction point.&quot;
      break
    }
    
    Out-File (Add-File Desktop.ini) -InputObject $ini -Encoding ASCII
    
    $wsh = New-Object -ComObject WScript.Shell
    $lnk = $wsh.CreateShortcut((Add-File target.lnk))
    $lnk.TargetPath = $(cvpa $TargetFolder)
    $lnk.Save()
    
    attrib +s $JunctionPoint /s /d
  }
  end {}
}
</code></pre>

</div>

    <footer class="blog-footer">
        <p>&copy; Joel &quot;Jaykul&quot; Bennett 2018</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="/js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>