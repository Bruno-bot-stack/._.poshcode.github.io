<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="Sign up for PowerShell.Slack.com">
    <meta name="author" content="JasonMArcher">
    <title>Get-HostsFile - PoshCode</title>

    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/main.css">
    <style>
        body {
            padding-top: 50px;
            padding-bottom: 20px;
        }
    </style>

    <link rel="openid2.provider" href="https://openid.stackexchange.com/openid/provider">
    <link rel="openid2.local_id" href="https://openid.stackexchange.com/user/b167be35-3674-4571-8142-df1f7dcfc268">
<!--
    <link rel="openid2.provider" href="https://www.google.com/accounts/o8/ud" />
    <link rel="openid2.local_id" href="https://profiles.google.com/+JoelBennett" />
-->
</head>
<body>
    <header>
    <nav class="navbar navbar-expand-sm fixed-top navbar-dark bg-dark">
        <div class="container">
            <div class="navbar-header">
                <a class="navbar-brand" href="http://PoshCode.org/">PoshCode</a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
            </div>
            <div id="navbarResponsive" class="collapse navbar-collapse navbar-responsive-collapse navbar-right">
                <ul class="nav navbar-nav nav-tabs ml-auto" data-tabs="tabs" id="tabs">
                    <li class="nav-item"><a class="nav-link active show" href="/Scripts" data-toggle="tab">Scripts</a></li>
                    <li class="nav-item"><a class="nav-link" href="/video" data-toggle="tab">Video Feed</a></li>
                </ul>
            </div><!--/.navbar-collapse -->
        </div>
    </nav>
    </header>

    

<h1>Get-HostsFile</h1>
<h3><a href="//scripts/2568.ps1">download</a> - <a href="//scripts/2565.md">parent</a></h3>
<p>This function will allow you to retreive the contents of a hosts file on a local or remote system. This can be used with one or more systems.</p>
<pre><code class="language-posh">Function Get-HostsFile {
&lt;#
.SYNOPSIS
    Retrieves the contents of a hosts file on a specified system.
.DESCRIPTION
    Retrieves the contents of a hosts file on a specified system.
.PARAMETER ComputerName
    The computers to access.
.NOTES
    Name: Get-HostsFile
    Author: Boe Prox
    DateCreated: 15Mar2011

    1.1 - 2011-03-17 - Jason Archer
        Improved pipeline support (and fixed positional usage).
        Added custom object creation and incremental output (better performance and cleaner code).
        For local host, use local path.
        Added error messages for error conditions.
    1.0 - 2011-03-15 - Boe Prox
        Initial release.
.LINK
    http://boeprox.wordpress.com
.EXAMPLE
    Get-HostsFile &quot;server1&quot;

    Description
    -----------    
    Retrieves the contents of the hosts file on 'server1'.
#&gt;

[CmdletBinding()]
Param(
    [Parameter(Position = 0, ValueFromPipeline = $True, ValueFromPipelineByPropertyName = $True)]
    [ValidateNotNull()]
    [string[]]$ComputerName = &quot;localhost&quot;
)

Begin {
    $PSBoundParameters.GetEnumerator() | Foreach-Object {  
        Write-Verbose &quot;Parameter: $_&quot; 
    }
}

Process {
    Write-Verbose &quot;Starting process of computers&quot;
    ForEach ($c in $ComputerName ) {
        Write-Verbose &quot;Testing connection of $c&quot;
        If (Test-Connection -ComputerName $c -Quiet -Count 1) {
            Write-Verbose &quot;Validating path to hosts file&quot;

            if ($c -eq &quot;localhost&quot;) {
                $root = &quot;C:&quot;
            } else {
                $root = &quot;\\$c\C`$&quot;
            }

            If (Test-Path &quot;$root\Windows\system32\drivers\etc\hosts&quot;) {
                Switch -regex -file (&quot;$root\Windows\system32\drivers\etc\hosts&quot;) {
                    &quot;^#\w+&quot; {
                    }
                    &quot;^\d\w+&quot; {
                        Write-Verbose &quot;Adding IPV4 information to collection&quot;

                        $new = $_.Split(&quot;&quot;) | Where-Object {$_ -ne &quot;&quot;}
                        If ($new[2] -eq $null) {
                            $notes = $null
                        } Else {
                            $notes = $new[2]
                        }
                        New-Object PSObject -Property @{
                            ComputerName = $c
                            IPV4 = $new[0]
                            IPV6 = $null
                            Hostname = $new[1]
                            Notes = $notes
                        }
                    }
                    Default {
                        If (!(&quot;\s+&quot; -match $_ -OR $_.StartsWith(&quot;#&quot;))) {
                            Write-Verbose &quot;Adding IPV6 information to collection&quot;

                            $new = $_.Split(&quot;&quot;) | ? {$_ -ne &quot;&quot;}
                            If ($new[2] -eq $null) {
                                $notes = $null
                            } Else {
                                $notes = $new[2]
                            }
                            New-Object PSObject -Property @{
                                ComputerName = $c
                                IPV4 = $null
                                IPV6 = $new[0]
                                Hostname = $new[1]
                                Notes = $notes
                            }
                        }
                    }                        
                }
            } ElseIf (Test-Path &quot;$root\WinNT\system32\drivers\etc\hosts&quot;) {
                Switch -regex -file (&quot;$root\WinNT\system32\drivers\etc\hosts&quot;) {
                    &quot;^#\w+&quot; {
                    }
                    &quot;^\d\w+&quot; {
                        Write-Verbose &quot;Adding IPV4 information to collection&quot;

                        $new = $_.Split(&quot;&quot;) | ? {$_ -ne &quot;&quot;}
                        If ($new[2] -eq $null) {
                            $notes = $null
                        } Else {
                            $notes = $new[2]
                        }
                        New-Object PSObject -Property @{
                            ComputerName = $c
                            IPV4 = $new[0]
                            IPV6 = $null
                            Hostname = $new[1]
                            Notes = $notes
                        }
                    }
                    Default {
                        If (!(&quot;\s+&quot; -match $_ -OR $_.StartsWith(&quot;#&quot;))) {
                            Write-Verbose &quot;Adding IPV6 information to collection&quot;

                            $new = $_.Split(&quot;&quot;) | ? {$_ -ne &quot;&quot;}
                            If ($new[2] -eq $null) {
                                $notes = $null
                            } Else {
                                $notes = $new[2]
                            }
                            New-Object PSObject -Property @{
                                ComputerName = $c
                                IPV4 = $null
                                IPV6 = $new[0]
                                Hostname = $new[1]
                                Notes = $notes
                            }
                        }
                    }                        
                }        
            } Else {
                ## TODO: Could use the properly localized path not found error
                Write-Error &quot;Unable to locate host file on computer: $c&quot;
            }
        } Else {
            ## TODO: Could use the properly localized can not locate host error
            Write-Error &quot;Unable to locate computer: $c&quot;    
        }
    }
}
}
</code></pre>

    <footer class="blog-footer">
        <p>Â© Joel "Jaykul" Bennett 2018.</p>
    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN"
        crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
    <script src="js/main.js"></script>

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-59988721-1', 'auto');
      ga('send', 'pageview');

      $(function () {
          $('#contentTabs a:first').tab('show')
      })

    </script>
</body>
</html>